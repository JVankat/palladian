<!doctype html public "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>The 'telco' benchmark
</title>
<meta name="owner"    content="mfc@speleotrove.com">
<meta name="review"   content="2008.12.01">
</head>
<body bgcolor="#FFFFFF">
<img src="thinkten.gif" alt="think 10" width=128 height=110 align=right>
    <a name=top>
    <font size=6 face=Helvetica color=darkblue><b>
    The &#8216;telco&#8217; benchmark
    <br>
    <font size=-1>
    A simplified billing application
    </font>
    </b></font>
    </a>
    <p>
<br>
<hr><!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = -->
    <p>
    This benchmark was devised in order to investigate the balance
    between Input and Output (I/O) time and calculation time in a
    simple program which captures the essence of a telephone company
    billing application.  It does not attempt to cover a wide
    spectrum of decimal operations and so is not suitable for
    benchmarking decimal implementations; modern applications often
    need much greater precision and also alignment, division,
    conversion, and rounding operations which do not appear in this
    benchmark.

    <p>
    In summary, the benchmark reads a large input file containing a
    suitably distributed list of telephone call durations (each in
    seconds).  For each call, a charging rate is chosen and the price
    calculated and rounded to hundreths.  One or two taxes are
    applied (depending on the type of call) and the total cost is
    converted to a character string and written to an output file.
    Running totals of the total cost and taxes are kept; these are
    displayed at the end of the benchmark for verification.

    <p>
    Full details and a discussion of the design parameters are
    included in
    <a href="http://speleotrove.com/decimal/telcoSpec.html">
    <i>The &#8216;telco&#8217; benchmark specification</i>.
    </a>
    Links to the sample data files may be found <a
    href=#datafiles>below</a>.

    <p>
    The following table gives some initial results, derived using the
    sample benchmark programs linked from the table.  Comments and
    corrections are invited.
    <p>

<hr><!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = -->

<h3><font face=Helvetica color=darkblue>
Initial results</font></h3>
  <p>
  In this table, each implementation is shown on a separate row.  The
  columns are:
  <ol>
  <li>The language used in the implementation.
  <li>A link to the sample source code for the benchmark.
  <li>The percentange of the benchmark time which is spent in the
      decimal arithmetic calculations (including roundings and
      conversions).  For measurements in this column the input and
      output files are on a local disk.
  <li>As the third column, except that the input and output files are on
      a different machine (connected via fast Ethernet).  This scenario
      gives a &#8216;worst case&#8217; I/O time (and hence the
      &#8216;best case&#8217; calculation percentage).  A database
      implementation would be between the two cases.
  <li>Implementation-specific notes.
  </ol>


<table width=100% border=2 cellpadding=5 bgcolor=#ffffE0>

  <tr align=center bgcolor=#ffffC0>
    <td><font face=Helvetica><b>Language</b></font></td>
    <td><font face=Helvetica><b>Source</b></font></td>
    <td><font face=Helvetica><b>Local File I/O</b></font></td>
    <td><font face=Helvetica><b>Ethernet I/O</b></font></td>
    <td align=left><font face=Helvetica><b>Notes</b></font></td>
    </tr>

  <tr align=center valign=top>
    <td><b>C</b>
    <td>
        <a href="http://speleotrove.com/decimal/cTelco.c">
        <b>cTelco.c</b></a>
        </td>
    <td>72.2%</td>
    <td>50.3%</td>
    <td align=left><font size=-1>
        Compiler: VisualAge(TM) for C++ for Windows(R), Version 3.5
        <br>
        Input file: expon180.1e6
        <br>
        Uses the decNumber.c package for calculations.  DECDPUN=4.
        </font></td>
    </tr>

  <tr align=center valign=top>
    <td><b>C</b>
    <td>
        <a href="http://speleotrove.com/decimal/cTelco754r.c">
        <b>cTelco754r.c</b></a>
        </td>
    <td>73.4%</td>
    <td>50.8%</td>
    <td align=left><font size=-1>
        Compiler: GCC-3.2-core-20020817-1 (MinGW 2.0.0)
        <br>
        Input file: expon180.1e6r (decimal64 format numbers)
        <br>
        Uses the decNumber.c package for calculations.  DECDPUN=4.
        </font></td>
    </tr>

  <tr align=center valign=top>
    <td><b>C#</b>
    <td>
        <a href="http://speleotrove.com/decimal/csTelco.cs">
        <b>csTelco.cs</b></a>
        </td>
    <td>76.4%</td>
    <td>56.9%</td>
    <td align=left><font size=-1>
        Compiler: Visual C# .NET Compiler version 7.00.9466
        <br>
        Input file: expon180.1e6b
        <br>
        Uses the native decimal type (implemented by the .Net Decimal
        class) for calculations.
        </font></td>
    </tr>

  <tr align=center valign=top>
    <td><b>Java</b>
    <td>
        <a href="http://speleotrove.com/decimal/jTelco.java">
        <b>jTelco.java</b></a>
        </td>
    <td>93.2%</td>
    <td>88.2%</td>
    <td align=left><font size=-1>
        Compiler: javac (in Java 1.3)
        <br>
        Input file: expon180.1e6b
        <br>
        Uses the java.math.BigDecimal class for calculations.
        </font></td>
    </tr>

</table>
<p>
<b>General Notes:</b>
  <ol>
  <li>All timings used the best of three measurements.
  <li>The local machine for all tests except cTelco754r was an IBM
      Intellistation Model 6889 (450MHz Pentium II, SCSI disks, 256MB
      RAM).  For the cTelco754r test, a Shuttle X (3GHz, Pentium 4,
      ATA disk, 1GB) was used.
  <li>For the Ethernet I/O tests, the data files were held on
      a Thinkpad T21 (800MHz Pentium III, IDE disk, 256MB RAM),
      connected by a 100MHz Ethernet link via one hub.
  <li>The I/O time (local I/O) averaged over all three implementations
      on the Intellistation was 2.75 microseconds per number.
  <li>The tax calculations were between 35% and 50% of the total
      calculation time, depending on the implementation.
  </ol>

<hr><!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = -->

<h3><font face=Helvetica color=darkblue>
<a name="others">Other results</a></font>
</h3>
  <ul>
  <li>
  William M. Klein has implemented the specification in COBOL,
  available at:
  <a href="http://home.comcast.net/~wmklein/DOX/TELCO.txt"><tt>
  http://home.comcast.net/~wmklein/DOX/TELCO.txt</tt></a>.
  <br>
  These timings were created using the Fujitsu compiler.  The same
  source code should also compile with Micro Focus compiler.
  <p>

  <li>
  Glenn Someone has implemented the specification in Turbo Pascal 7.0,
  available in:
  <a href="http://groups.google.com/groups?dq=&hl=en&lr=&ie=UTF-8&group=comp.lang.pascal.borland&selm=bh9oc0t8fkgv875lf06abpfv5otf6h8m59%404ax.com">comp.lang.pascal.borland</a>
  <br>
  The timings shown below are on the test file expon180.1e6b, run
  on a Celeron 433Mhz PC.

  </ul>
  <table border=1 cellpadding=8 bgcolor=#ffffE0>
    <tr valign=top>
      <td colspan=3>
        <b>Timings summary</b> &nbsp; (local file I/O unless stated)</td>
      </tr>
    <tr valign=top>
      <td><b>Author</b>
      <td><b>Language</b>
      <td><b>Results</b>
      </tr>
    <tr valign=top>
      <td rowspan=2>William M. Klein
      <td>Standard COBOL </td>
      <td>
        with calculations: 23.08s
        <br>&#8216;skipping&#8217; calculations: 8.31s
        <br>calculations time: 64%
        </td>
      </tr>
    <tr valign=top>
      <td>Using COMP-5 binary temporaries </td>
      <td>
        with calculations: 13.59s
        <br>&#8216;skipping&#8217; calculations: 7.29s
        <br>calculations time: 46%
        </td>
      </tr>
    <tr valign=top>
      <td>Glenn Someone
      <td>Turbo Pascal 7.0, using scaled long ints
      <td>
        with calculations: 29.55s
        <br>&#8216;skipping&#8217; calculations: 21.80s
        <br>calculations time: 26%
        </td>
      </tr>
  </table>
  <p>

<hr><!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = -->

<h3><font face=Helvetica color=darkblue>
<a name="datafiles">Data files</a></font></h3>
  <p>
  Two data collections are available for use with the benchmark source
  files; one is a short test file comprising ten numbers; the other
  contains one million numbers (7.63MBytes).
  Each file is available in three formats: 8-byte packed decimal,
  8-byte binary, and the decimal64 format from the
  <a href="http://www.validlab.com/754R/drafts/archive/2006-09-17.pdf">IEEE 754r draft</a>
  (one number in every eight bytes in all three cases).
  <p>
  All files were generated with an exponential distribution with mean
  set to 180; for the larger files the actual mean is 180.2 and the
  maximum value is 2641.
  <p>
  Here are the links to the files:

  <table border=2 cellpadding=5 bgcolor=#ffffE0>
    <tr align=center>
      <td>&nbsp;</td>
      <td><b>Packed decimal</b></td>
      <td><b>Binary</b></td>
      <td><b>decimal64</b></td>
      </tr>

    <tr align=center>
      <th>10-number test file</th>
      <td><a href="http://speleotrove.com/decimal/telco.test">
          <b>telco.test</b></a>
          </td>
      <td><a href="http://speleotrove.com/decimal/telco.testb">
          <b>telco.testb</b></a>
          </td>
      <td><a href="http://speleotrove.com/decimal/telco.testr">
          <b>telco.testr</b></a>
          </td>
      </tr>

    <tr align=center>
      <td><b>Million-number file</b><br>(zipped)</td>
      <td><a href="http://speleotrove.com/decimal/expon180-1e6.zip">
          <b>expon180.1e6</b></a>
          </td>
      <td><a href="http://speleotrove.com/decimal/expon180-1e6b.zip">
          <b>expon180.1e6b</b></a>
          </td>
      <td><a href="http://speleotrove.com/decimal/expon180-1e6r.zip">
          <b>expon180.1e6r</b></a>
          </td>
      </tr>
  </table>
  <p>
  Here is a worked example (using the numbers from the telco.test
  files) to aid verification of new implementations of the benchmark:
  <pre>
    Time Rate | Price   Btax   Dtax  | Output
  ------------+----------------------+--------
     308   L  |  0.40   0.02         |  0.42
      76   L  |  0.10   0.00         |  0.10
      68   L  |  0.09   0.00         |  0.09
     323   D  |  2.89   0.19   0.09  |  3.17
      82   L  |  0.11   0.00         |  0.11
     329   D  |  2.94   0.19   0.10  |  3.23
      14   L  |  0.02   0.00         |  0.02
     101   D  |  0.90   0.06   0.03  |  0.99
     522   L  |  0.68   0.04         |  0.72
      50   L  |  0.06   0.00         |  0.06
  ------------+----------------------+--------
     Totals:  |  8.19   0.50   0.22  |  8.91
  </pre>
  To verify correct rounding rules, <i>etc.</i>, the final totals for the
  million-number files must also match the values shown in the
  specification.

  <font size=-1>
  <p><b>Note:</b>
  Not all rounding cases are covered in the small test file.
  A round-down-to-even case is covered in the last record (50 &times;
  0.0013 &rarr; 0.065 which is truncated to 0.06 because 6 is even),
  but a round-up-to-even case is not covered, for example 550 &times;
  0.0013 &rarr; 0.715 which should be rounded up to 0.72.  The latter
  example can be found as the 5873<sup>rd</sup> entry in the main
  test file (at offset hex 16F0).
  </font>

<p>
<hr><!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = -->

<table width=100% cellpadding=4><tr><td valign=top bgcolor=#FFFFFF>
Please send any comments or corrections to
<a href="http://speleotrove.com/mfc/">Mike Cowlishaw</a>,
<a href="mailto:mfc@speleotrove.com"><tt>mfc@speleotrove.com</tt></a>
</td>
</tr>

<tr valign=top>
<td>
<em>Copyright &copy; IBM Corporation 2002, 2006.  All rights reserved.</em>
<font size=-2>
<br>
Java is a trademark of Sun Microsystems Inc.
<script><!--
var lm=Date.parse(document.lastModified)
if (lm!=0) {
  var dlm=new Date(lm)
  var y=dlm.getYear();    if (y<100) y+=100; if (y<1000) y+=1900
  var m=dlm.getMonth()+1; if (m<10) m='0'+m
  var d=dlm.getDate();    if (d<10) d='0'+d
  var rdate=y+'.'+m+'.'+d
  document.write('&nbsp;&nbsp;This page was created on ')
  document.write(rdate+'.')
  }
//--></script>
</font>
</td></tr>


</tr></table>

</body>
</html>
