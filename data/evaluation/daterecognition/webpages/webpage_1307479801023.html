<html>

<head>
<title>Editing RTF Files for Browser Presentations</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<link rel="stylesheet" type="text/css" href="../../default.css">
<meta name="Microsoft Border" content="tlrb, default">
</head>

<body bgcolor="#FFFFFF" text="#000000" topmargin="2" leftmargin="2"><!--msnavigation--><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td>
<div align="center">
  <center>
  <table border="0" width="100%" cellspacing="0" cellpadding="2" class="TopNav">
    <tr>
      <td width="64" bgcolor="#250080" rowspan="2" valign="top" align="left"><a href="../../index.html" target="_top"><img border="0" src="../../images/pbdrcogs.gif" width="52" height="36"></a></td>
      <td bgcolor="#250080" width="385" valign="top" align="left" rowspan="2"><b><font face="Tahoma" size="5" color="#FFFFFF">PBDR.COM</font></b></td>
    <td bgcolor="#250080" valign="middle" align="right">
      <p align="right"><b><font size="1"><a href="../../About.htm"><font color="#FFFFFF">About</font></a><font face="Tahoma" color="#FFFFFF">&nbsp;&nbsp;
      -&nbsp;&nbsp; </font><a href="../../sendmail.htm"><font face="Tahoma" color="#FFFFFF">
      Contact</font></a><font face="Tahoma" color="#FFFFFF">&nbsp;&nbsp; -&nbsp;&nbsp;
      </font><a href="../../software/order.htm"><font face="Tahoma" color="#FFFFFF"> Purchase</font></a><font face="Tahoma" color="#FFFFFF">&nbsp;&nbsp; -&nbsp;&nbsp;
      </font><a href="../../search/searchen.htm"><font face="Tahoma" color="#FFFFFF">
      Search</font></a><font face="Tahoma" color="#FFFFFF">&nbsp;&nbsp; -&nbsp;&nbsp;
      </font><a href="../../WhatsNew.htm"><font face="Tahoma" color="#FFFFFF"> What's New</font></a></font></b>
      </td>
  </tr>
    <tr>
    <td bgcolor="#250080" valign="bottom">
      &nbsp;</td>
  </tr>
  </center>
  <tr>
    <td bgcolor="#250080" colspan="3" align="right">
      &nbsp;
    </td>
  </tr>
  <center>
</table>
  </center>
</div>
</td></tr><!--msnavigation--></table><!--msnavigation--><table dir="ltr" border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td valign="top" width="1%">
<table border="0" width="200" height=100% cellspacing="0" cellpadding="0" bgcolor="#B5C6E7" style="border-right:solid 1px #000; border-bottom:solid 1px #000">
<tr><td valign=top>
<table border="0" width="200" cellspacing="0" cellpadding="0">
  <tr>
    <td width="100%" class="NavHeader">Search</td>
  </tr>
  <tr>
    <td width="100%"><form method="GET" action="http://www.pbdr.com/search/searchen.htm"><input title="Search in pbdr.com using Google." class="NavSearch" type="text" name="terms" size="15">
    </td></form>
  </tr>
  <tr>
    <td width="100%" class="NavHeader"><a title="Visit the Articles homepage" href="/Articles.htm" class="NavHeadAnchor">Articles</a</td>
      </a>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><A title="User Interface Standards, make your GUI applications user friendly." href="/guistd/index.htm" class="NavAnchor">GUI Standards</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="Small collection of useful business application type Javascripts." href="/jscript/index.htm" class="NavAnchor">Java Script Tips</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="Improve your productivity, understand how the OS works and how to extend it." href="/ostips/index.htm" class="NavAnchor">Operating System Tips</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="PowerBuilder standards for coding, naming, style and commenting." href="/pbstd/index.htm" class="NavAnchor">PowerBuilder Standards</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><A title="Tips, Tricks and articles for PowerBuilder." href="/pbtips/index.htm" class="NavAnchor">PowerBuilder Tips</A></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="Visual Basic standards for coding, naming, style and commenting." href="/vbstd/index.htm" class="NavAnchor">Visual Basic Standards</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="Tips, Tricks and articles for Visual Basic." href="/vbtips/index.htm" class="NavAnchor">Visual Basic Tips</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavHeader"><a title="Find out more about our range of utilities." href="/software/utilities.htm" class="NavHeadAnchor">Products</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="Buy one of our products and find out about Promotional Packs." href="/software/order.htm" class="NavAnchor">Buy Now</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="PBBrowse is an advanced replacement for the Object browser shipped with PowerBuilder." href="/software/pbbrowse.htm" class="NavAnchor">PBBrowse</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="PBDelta compares and highlights changes made between versions of libraries and objects." href="/software/pbdelta.htm" class="NavAnchor">PBDelta</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="PBDoc produces professional quality documentation directly from your source code." href="/software/pbdoc.htm" class="NavAnchor">PBDoc</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="PBPaste pastes dynamic and static script directly into PowerBuilder; Comment Headers and much more." href="/software/pbpaste.htm" class="NavAnchor">PBPaste</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavHeader"><a title="Visit the software homepage" href="/Software.htm" class="NavHeadAnchor">Software</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="Free database utilities to speed your database work." href="/software/dbutil/index.htm" class="NavAnchor">Database Utilities</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="Over 50 free PowerBuilder components with source code and documentation." href="/software/comp.htm" class="NavAnchor">PowerBuilder Components</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavHeader"><a title="Visit the Links homepage" href="/Link.htm" class="NavHeadAnchor">Links</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="A collection of categorised links to general development/programming related sites." href="/links/dev.htm" class="NavAnchor">Development Links</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="Over 100 categorised Links to other PowerBuilder related sites." href="/links/pb.htm" class="NavAnchor">PowerBuilder Links</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="A collection of categorised links to development reference sites." href="/links/devref.htm" class="NavAnchor">Reference Links</a></td>
  </tr>
  <tr>
    <td width="100%" class="NavAnchor"><a title="A small but growing collection of categorised Links to other Visual Basic related sites." href="/links/vb.htm" class="NavAnchor">Visual Basic Links</a></td>
  </tr>
</table>
</td></tr>
</table>
</td><td valign="top" width="24"></td><!--msnavigation--><td valign="top">
<div align="center"><center>

  <TABLE border=0 width=615>
  <TBODY>
  <tr>
    <td width="100%" bgcolor="#250080"><font size="5" style="font-weight:bold;" color="#FFFFFF">Editing RTF Files for Browser Presentations</font></td>
  </tr>
  <tr>
    <td width="100%">
      Although HTML is great for formatting information on a page, when it comes
      to printing, problems arise due to the absence of a page break facility. As
      a result the printed HTML document contains information continually output over
      multiple pages without any predetermined breaks. In addition, the point at
      which a page ends and a new one begins is determined by the browser font
      size, font type, printer type and printer driver. This is unfortunate as
      ASP and HTML are two complimentary languages, capable of good database retrieval
      and data formatting together.
      <p>In search of an alternative, I created a VB ActiveX DLL to modify a
      Word template on the web server. The template was an empty formatted report, which was
      subsequently populated from the results of a query. As many records
      existed, the DLL was passed the unique key ID and the report was populated
      with the relevant data. Again, more problems arose, as the DLL required a
      reference to the MS Word Object Library, which in turn requires an
      instance of WinWord to be loaded into memory on the web server. Under
      periods of heavy user activity, the overhead of multiple instances of
      WinWord, at 8.5Mb a piece, began to effect web server performance.</p>
      <p>The easiest and most efficient solution was to use RTF files in place of Word
      documents, because firstly they are usually smaller and quicker to
      download and secondly they're ASCII based, so do not require the overhead
      of anything of the scale of the Word Object Library to manipulate them. In
      fact, all the RTF template editing was undertaken by VB's
      file-handling.&nbsp;Consider the RTF table below containing 2 columns,
      each with its own justified text.</p>
      <p align="center"><img border="0" src="images/rtf.jpg" width="527" height="46"></p>
      <p>The rtf file that forms this simple document contains lines &amp; lines
      of formatting as ASCII characters, but searching for the text in the cells
      returns the following line associated specifically with this grid and text:&nbsp;</p>
      <pre>   {\f28 Data Title:\par }\pard\plain \ql \li0\ri0\widctlpar\intbl\
   faauto\adjustright\rin0\lin0 \fs20\lang2057\langfe1033\cgrid\
   langnp2057\langfenp1033 {\b\caps\f28 \cell } {#Data1#}
   {\b\caps\f28 \cell }</pre>
      The line above is actually one continuous line in the rtf file, and is
      typical of the length of most of the lines. Then I used the function<pre>   Line Input #1, strRTFLineData</pre>
      <p>to retrieve each line from the RTF template. Next the search command
   

</p>
      <pre>   Instr(strRTFLineData, &quot;#Data1&quot;)</pre>
      <p>was employed to determined if the line contained the identifier text to
      be replaced. Once located, the identifier text was replaced with the
      appropriate data (in this case a string containing data from a table)
      using
   

</p>
      <pre>   Replace(strRTFLineData, &quot;#Data1&quot;, strDataItem)</pre>
      <p>Whether a substitution was carried out or not, each input line was
      written to a flat file line by line to create an updated RTF file. The
      only additional code was to return the output RTF file's path for the ASP
      code to locate the newly created report. In reality, as many cells existed
      in the several tables in the template RTF, I used a series of if...elseif...else
      conditions as follows.
   

</p>
      <pre>   If Instr(strRTFLineData, &quot;#Data1&quot;) &gt; 0 Then
   	<font color="#008000">'replace &amp; write line to output RTF</font>
   ElseIf Instr(strRTFLineData, &quot;#Data2&quot;) &gt; 0 Then
        <font color="#008000">'replace &amp; write line to output RTF</font>
   ElseIf Instr(strRTFLineData, &quot;#Data3&quot;) &gt; 0 Then
       <font color="#008000"> 'replace &amp; write line to output RTF</font>
   Else	
        <font color="#008000">'just write line to output RTF</font>
   End If</pre>
      <p>The code was then compiled as an ActiveX DLL and registered on the web
      server.
   

</p>
 </td>
  </tr>
  </TBODY></table></center></div>&nbsp;<!--msnavigation--></td><td valign="top" width="24"></td><td valign="top" width="1%">

<table border="0" cellpadding="0" cellspacing="0" width="120">
<tr height=8><td height="8">
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1190907-1";
urchinTracker();
</script>
</td></tr>
  <tr align=right>
    <td width="100%">
<script type="text/javascript"><!--
google_ad_client = "pub-6938081794727235";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text";
google_ad_channel ="";
google_color_border = "B5C6E7";
google_color_bg = "FFFFFF";
google_color_link = "003163";
google_color_url = "003163";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
  </tr>
</table>

</td></tr><!--msnavigation--></table><!--msnavigation--><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td>
<div align="center">
  <center>
  <table border="0" cellpadding="2" cellspacing="0" width="615">
    <tr>
      <td colspan="2">
        <p align="center"><a href="#top"><font face="Tahoma" size="2">Top of Page</font></a></td>
    </tr>
    <tr>
      <td><a href="../../about/legal.htm"><font face="Tahoma" size="1">Legal Notice</font></a></td>
      <td><p align="right"><font face="Tahoma" size="1">� <a href="../../sendmail.htm">Ken Howe</a> 
        2011</font></td>
    </tr>
  </table>
  </center>
</div>
<p>&nbsp;</p>
</td></tr><!--msnavigation--></table></body></html>

