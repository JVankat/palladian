<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">


<html>

<head>
	<title>A Word add-in to syntax highlight selected text - CodeProject</title> 
	<link type="text/css" rel="stylesheet" href="http://s.codeproject.com/App_Themes/Std/CSS/CodeProject.min.css?dt=2.3.110104.1">

	
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
<meta name="Description" content="A Word addin to syntax highlight selected text. The toolbar is permanent, with a transparent button icon.; Author: sswater shi; Section: COM / COM+; Chapter: Platforms, Frameworks &amp; Libraries" >
<meta name="Keywords" content="VC6, Win2K, WinXP, Win2003, Dev, COM, Intermediate,COM / COM+,Platforms, Frameworks &amp; Libraries,Free source code, tutorials" >
<meta name="Author" content="The Code Project" >
<meta name="Rating" content="General" >
<meta name="Robots" content="index, follow" >
<meta name="Revisit-After" content="1 days" >
<meta name="google-site-verification" content="RP2bNCUeOmNkkJesEnU8X3UyTbqIcCKP0CmdwU8in5k" >
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All topics" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" >
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - MFC / C++" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" >
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - C#" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" >
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - ASP.NET" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" >
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - .NET" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" >
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - VB.NET" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" >
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="http://www.codeproject.com/webservices/LoungeRSS.aspx" >
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="http://www.codeproject.com/info/OpenSearch.xml" >

	<base target="_top">
	<link rel="icon" href="/favicon.ico" type="image/ico" >
<link rel="shortcut icon" href="/favicon.ico"  type="image/ico" >
<link rel="apple-touch-icon" href="/images/FavIcon-Apple.png" type="image/png" >
<script type="text/javascript" language="Javascript">//<![CDATA[
if(top!=self)top.location.href=location.href; if(typeof(DemoUrl)!="undefined")document.write(unescape('%3Cme')+'ta http'+'-equiv="re' +'fresh" con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));
function SelfCheck(){ return window.confirm("You are about to reply to your own message. Is this really what you want?");}
var Selected = "-1";
function Pin(elm){
 CloseMsg(Selected);
 var wrk=elm.parentNode; if(wrk)wrk=wrk.children[0];
 var fc=elm?elm.firstChild:null;
 if (wrk&&!wrk.pinned) {
  OpenMsg(wrk.name, true);wrk.pinned=true;fc.src='http://s.codeproject.com/script/forums/images/pinned.gif';fc.title='Pinned. Click to unpin'
 } else {
  wrk.pinned=false;CloseMsg(wrk.name); fc.src='http://s.codeproject.com/script/forums/images/pin.gif';fc.title='Click to pin message'
 }
 return false;
}
function CloseMsg(msgId) {
 if(!msgId||msgId==''||msgId<0)return;
 var lnk=document.getElementsByName(msgId);
 if(lnk&&lnk.length>0&&lnk[0].pinned)return;
 var hed=document.getElementById('F' + msgId.toString() + '_h0');
 if(hed) hed.className = hed.className.replace("Sel", "UnSel");
 var bdy=document.getElementById('F' + msgId.toString() + '_h1');
 if(bdy) bdy.style.display = 'none';
}
function OpenMsg(msgId, keep) {
 if(!msgId||msgId==''||msgId<0)return;
 var bdy=document.getElementById('F' + msgId.toString() + '_h1');
 if(bdy){
  var lnk=document.getElementsByName(msgId);
  if(lnk&&lnk.length>0&&lnk[0].pinned)keep=true;
  if(keep&&bdy.style.display!='none')return;
  if(bdy.style.display=='none') bdy.style.display='';
  else bdy.style.display = 'none';
 }
 var hed=document.getElementById('F' + msgId.toString() + '_h0');
 if (hed) hed.className = hed.className.replace('UnSel', 'Sel');
 if(bdy&&hed&&bdy.style.display!='none'){
  var webkitWeird=document.documentElement.scrollTop < document.body.scrollTop;
  if (!webkitWeird)document.body.scrollTop = getRealPos(hed, 'Top') - document.body.clientHeight/10;
  EnsureMessageVisible(msgId, true);
 }
}
function EnsureMessageVisible(msgID, bShowTop) {
	var webkitWeird = document.documentElement.scrollTop < document.body.scrollTop;
	var msgHeader = document.getElementById('F' + msgID + '_h0');
	var msgBody = document.getElementById('F' + msgID + '_h1');
	if (!msgBody || !msgHeader) return;
	var scrollContainer = document.documentElement;
	var top = getRealPos(msgHeader, 'Top');
	var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;
	var scrollTop = webkitWeird? scrollTop = document.body.scrollTop:document.documentElement.scrollTop;
	if (scrollTop > top && !bShowTop) scrollTop = top - scrollContainer.clientHeight / 10;
	if (scrollTop + scrollContainer.clientHeight < bottom) scrollTop = bottom - scrollContainer.clientHeight;
	if (scrollTop > top && bShowTop) scrollTop = top - scrollContainer.clientHeight / 10;
	if (webkitWeird) document.body.scrollTop = scrollTop; else scrollContainer.scrollTop = scrollTop;
}
function getRealPos(i,which) {
	iPos = 0;
	while (i!=null)  {
		iPos += i['offset' + which];
		i = i.offsetParent;
	}
	return iPos;
}

function SwitchMessage(e, msgId)
{

  if (msgId) msgId=msgId.toString();

  else {

    if(!e)e=window.event;

    var target=e.target?e.target:e.srcElement;

    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    if(target.pinned){Selected='';return false;}
    msgId=target.name;
  }
  CloseMsg(Selected)
  if(Selected==msgId) Selected='';
  else { OpenMsg(msgId, false); Selected=msgId;}
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}


//]]>
</script>

</head>	

<body>

<a href="#Main"><img alt="Click here to Skip to main content" class="access-link" 
	src="http://s.codeproject.com/Images/t.gif" /></a>


<div class="page-background">
	<div id="A" class="container-content">

		
		

		
		

<div class="container nav-memberbar clearfix">
<div class="member-stats float-left">7,496,844 members and growing! (25,101 online)</div>
<div class="float-left"></div>
<div class="float-right">



	<a name="SignUp"></a>
	<form name="subForm" id="subForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx" method="post" class="tight">

	<!-- This hidden field is used for identifying the form which has made post request.
		 (This form posts to another page and we need to know which form did the post request) -->
	<input id="FormName" name="FormName" value="MenuBarForm" type="hidden" />

	Email <input class="small-text" type="text" name="Email" id="Email" style="width:150px" />
	Password <input class="small-text" type="password" name="Password" id="Password" style="width:60px" />
	<input type="submit" value="Sign in" class="button" />
	<script type="text/javascript">
function Join(){document.location.href='https://www.codeproject.com/script/Membership/Modify.aspx';return false;}
document.write('<input type="button" class="button" onclick="return Join();" value="Join"');
document.write('<input type="hidden" name="fld_quicksign" value="true" />');
</script>
	<span class="nowrap">
		<input type="checkbox" checked = "checked" name="RememberMeCheck" id="RememberMeCheck" value="1"/>
		<label for="RememberMeCheck">Remember&nbsp;me?</label>
	</span>&nbsp;
	<a id="ctl00_MemberMenu_SendPassword" href="/script/Membership/SendPassword.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Lost password?</a>
	</form>

</div>

</div>
		

		
		<table width="100%" cellspacing="0" cellpadding="0" border="0">
		<tr>
			<td class="header"><a href="/"><img id="ctl00_Logo" title="The Code Project" src="http://s.codeproject.com/App_Themes/Std/Img/logo225x90.gif" alt="Home" style="border-width:0px;" /></a></td>
			<td class="header" align="right">
				<div class="lqm_ad" width="728px" height="90px" lqm_channel="1" lqm_publisher="495" lqm_zone="77" lqm_format="8" lqm_country='IR' lqm_tags='VC6,Win2K,WinXP,Win2003,Dev,COM,Intermediate'></div>
			</td>
		</tr></table>

		<table cellpadding="0" cellspacing="0" class="contrast1-background extended"><tr><td nowrap="nowrap">
			

<div class="navbar clearfix">
<ul id="nav">

<li><a id="ctl00_TopNavBar_Home" class="down" href="http://www.codeproject.com">Home</a>

<li><a id="ctl00_TopNavBar_Art" class="down selected" href="/script/Articles/Latest.aspx">Articles</a>

	<ul>
		<li><a id="ctl00_TopNavBar_ArtTopicList" class="fly last" onmouseover="PopulateMap(this, &#39;siteMap&#39;, &#39;600px&#39;);" href="/script/Content/SiteMap.aspx">Chapters and Sections</a><ul id="ctl00_TopNavBar_MapFlyout"><li>
				<div id="siteMap" style="height:0px;width:0px;border:1px solid green;background-color:white;overflow:scroll">
					<img src="/images/animated.gif" style="margin:150px;width:100px;height:100px;" />
				</div>
			</li></ul>
		</li>
		<li><a id="ctl00_TopNavBar_ArtSearch" class="fly break" href="/info/search.aspx">Search</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="/script/Articles/Latest.aspx">Latest Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestTips" class="fly" href="/script/Articles/Latest.aspx?at=6">Latest Tips/Tricks</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="/script/Articles/TopArticles.aspx?ta_so=4">Top Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBeginner" class="fly" href="/info/search.aspx?aidlst=152&amp;sa_us=True">Beginner Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBlogArticles" class="fly break" href="/script/Articles/BlogArticleList.aspx">Technical Blogs</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly" href="/info/Submit.aspx">Post an Article</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostTipTrick" class="fly" href="/Tips/post.aspx">Post Tip & Trick</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly break" href="/script/Articles/BlogFeed.aspx">Post your Blog</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtCompetition" class="fly last" href="/script/Awards/CurrentCompetitions.aspx?cmpTpId=1">Article Competition</a></li>
	</ul>

</li>



<li><a id="ctl00_TopNavBar_Answers" href="/script/Answers/List.aspx?tab=active">Questions & Answers</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight" href="#_comments">Ask a Question about this article</a></li>

		<li class="heading">Quick Answers</li>
		<li><a id="ctl00_TopNavBar_QAAsk" class="fly" href="/Questions/ask.aspx">Ask a Question</a></li>
		
		
		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="/script/Answers/List.aspx?tab=active">View All Questions...</a></li>
		
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;tags=81" style="padding-left:30px">C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;tags=85" style="padding-left:30px">ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;tags=842" style="padding-left:30px">VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;tags=78" style="padding-left:30px">C++ questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;tags=69" style="padding-left:30px">C#3.0 questions</a></li>
			
		<li class="heading">Programming Discussions</li>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="/script/Forums/List.aspx">All Message Boards...</a></li>
		<li><a class="fly" style="padding-left:30px" href="/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="fly-menu">&gt;</span></a>
<ul><li><a class="fly" href="/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a></li>
<li><a class="fly" href="/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="/Forums/3304/Work-Training-Issues.aspx">Work &amp; Training Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="fly-menu">&gt;</span></a>
<ul><li><a class="fly" href="/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1725/Database.aspx">Database</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1642/IT-Infrastructure.aspx">IT &amp; Infrastructure<span class="fly-menu">&gt;</span></a>
<ul><li><a class="fly" href="/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices</a></li>
<li><a class="fly" href="/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1540733/Sharepoint.aspx">Sharepoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1640/Web-Development.aspx">Web Development<span class="fly-menu">&gt;</span></a>
<ul><li><a class="fly" href="/Forums/12076/ASP-NET.aspx">ASP.NET</a></li>
<li><a class="fly" href="/Forums/1580227/CSS.aspx">CSS</a></li>
<li><a class="fly" href="/Forums/1580226/Javascript.aspx">Javascript</a></li>
<li><a class="fly" href="/Forums/1213656/PHP.aspx">PHP</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1645/Site-Bugs-Suggestions.aspx">Site Bugs / Suggestions</a>
</li>


		<li class="heading">Other Languages<span class="fly-menu">&gt;</span>
		<ul>
		<li><a class="fly" href="/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		<li><a class="fly" href="/Forums/1580230/Chinese.aspx">General Chinese Topics</a></li>
		</ul></li>
	
	</ul>

</li>


<li><a id="ctl00_TopNavBar_Zones" href="/Zones/index.aspx">Learning Zones</a>

	<ul>
		<!--<li class="heading">Zones</li>-->
		<li><a href="/Zones/Commerce/" class="fly">The Commerce Zone</a></li><li><a href="/Zones/Mobile/" class="fly">The Mobile Zone</a></li><li><a href="/Zones/Cloud/" class="fly">The Cloud Zone</a></li><li><a href="/Zones/Hardware/" class="fly">The Hardware Zone</a></li><li><a href="/Zones/Parallelism/" class="fly">The Parallelism Zone</a></li><li><a href="/Zones/WPF-Silverlight/" class="fly">The WPF / Silverlight Zone</a></li><li><a href="/Zones/SqlServer/" class="fly">The SQL Zone</a></li><li><a href="/Zones/WhitePapers/" class="fly">WhitePapers / Webcasts</a></li>
	</ul>

</li>










<li><a id="ctl00_TopNavBar_Community">Features</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly" href="/script/Awards/MVPWinners.aspx">CodeProject MVPs</a></li>
		<li><a id="ctl00_TopNavBar_Companies" class="fly break" href="/script/Membership/Profiles.aspx?mgtid=1&amp;mgm=True">Company Listings</a></li>
		<li><a id="ctl00_TopNavBar_Catalog" class="fly" href="/script/Catalog/List.aspx">Component & Service Catalog</a></li>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="/script/Awards/CurrentCompetitions.aspx?cmpTpId=1&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="/Feature/Insider/">Daily Insider</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_PressRelease" class="fly" href="/script/PressReleases/Preview.aspx">Press Releases</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li><a id="ctl00_TopNavBar_AddIn" class="fly last" href="/Services/Addins/">CodeProject VS Addin </a></li>
	</ul>

</li>


<li><a id="ctl00_TopNavBar_Help" href="/KB/FAQs/">Help!</a>

	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="/info/guide.aspx">What is 'The Code Project'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly" href="/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly" href="/Questions/ask.aspx">Post a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="/Forums/1645/Site-Bugs-Suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpSiteMap" class="fly" href="/script/Content/SiteMap.aspx">Site Directory</a></li>
		<li><a id="ctl00_TopNavBar_HelpAdvertise" class="fly" href="/info/MediaKit.aspx">Advertise with us</a></li>
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly last" href="/info/about.aspx">About Us</a></li>
	</ul>

</li>


<li style="margin-left:10px">
<a id="ctl00_TopNavBar_Lounge" class="simple" href="/Lounge.aspx">The Lounge</a>

	<ul>
		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly" href="/Lounge.aspx">The Lounge  </a></li>
		<li><a id="ctl00_TopNavBar_CleverLnk" class="fly" href="/feature/CleverCode.aspx">Clever Code</a></li>
		<li><a id="ctl00_TopNavBar_ShameLnk" class="fly" href="/feature/HallOfSHame.aspx">Hall of Shame</a></li>
		<li><a id="ctl00_TopNavBar_SoapBoxLnk" class="fly" href="/Forums/1536756/The-Soapbox-2-0.aspx">The Soapbox</a></li>
		
	</ul>

</li>

</ul>

</div>

<script type="text/javascript">
function PopulateMap(prnt, elmId, width, height) {
	var map;
	if (!prnt.populated && !prnt.populating) {
		prnt.populating = true;
		map = $('#' + elmId);
		map.css('height', '400px');
		map.css('width', '400px');
		map.load("/script/content/ajax/SiteMap.aspx", function () {
			if (height) map.css('height', height); else map.css('height', 'auto');
			prnt.populated = true;
		});
		prnt.populating = false;
	}
	if (prnt.populated) {
		map = map||$('#' + elmId);
		var defWidth = ($(window).width() * 0.9);
		if (defWidth > 1000) defWidth = 1000;
		if (width) map.css('width', width); else map.css('width', defWidth+'px');
	}
}
</script>
		</td><td align="right">
			

<div class="search-bar">

<form method="get" action="/info/search.aspx" name="Search" class="tight">


<input class="search " id="sb_tb" value="" name="artkw" />

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced popup small-text align-left">
	<b>Search within:<br /></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="true"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>
<input type="radio" id="sb_ctlk" name="sbo" value="ctlk"><label for="sb_ctlk">Product Catalog</label><br>


		
		
	</div>
</div>
</form>

</div>
		</td></tr></table>
		

		
		<div class="container-article">
		
			
			<div class="container-header">
				<div id="ctl00_Header" class="header">

					<a name="Main"></a>

					
					<a name="_top"></a>
					

<div class="clearfix hover-container">

	<div class="container">
		
		<div class="breadcrumb float-left"><a href="/script/Content/SiteMap.aspx"><span class="sitemap-anchor" onmouseover="PopulateMap(this,'map');"><img width="16px" height="16px" src="/images/sitemap16.png" border="0" alt="Site map" style="vertical-align:middle" /><div id="map"><img src="/images/animated.gif" style="margin:150px;width:100px;height:100px;border:0;" /></div></span></a> &#187; <a href="/Chapters/8/Platforms-Frameworks-Libraries.aspx">Platforms, Frameworks & Libraries</a> &#187; <a href="/KB/COM/">COM / COM+</a> &#187; <a href="/KB/COM/#ActiveX">ActiveX</a></div>

		<div class="float-right">
			
			<a id="ctl00_TitleArea_PageWidth_Fixed" title="Fixed width layout" href="/KB/COM/wordhighlight.aspx?PageFlow=FixedWidth"><img class="toolbar"
	src="/images/fixed-width.png" style="width:18px;height:18px" /></a>

<a id="ctl00_TitleArea_PageWidth_Fluid" title="Fluid layout" href="/KB/COM/wordhighlight.aspx?PageFlow=Fluid"><img class="toolbar"
	src="/images/fluid-width.png" style="width:18px;height:18px" /></a>
		</div>
	</div>

	
	<div id="ctl00_TitleArea_InfoArea" class="float-right">
		

<div class="infobox">
	<table class="tight small-text" cellpadding="0" cellspacing="1">
	<tr><td>Licence&nbsp;</td><td><a href="http://www.codeproject.com/info/cpol10.aspx" title="The Code Project Open License (CPOL)">CPOL</a></td></tr>
	
	<tr><td>First Posted&nbsp;</td><td nowrap="nowrap"><b>18 May 2006</b></td></tr>
	<tr><td>Views&nbsp;</td><td><b>53,608</b></td></tr>
	
	<tr><td>Bookmarked&nbsp;</td><td><b>57 times</b></td></tr>
	
	
	
	
	<tr valign="top">
		<td>Tags&nbsp;</td>
		<td nowrap="nowrap">
			<span id="ctl00_TitleArea_InfoBox_TagsList_TagWrp" class="tags">
	
	<span id="ctl00_TitleArea_InfoBox_TagsList_TagLabel" class="bold"></span>
	
	<span id="ctl00_TitleArea_InfoBox_TagsList_VisibleTags"><a href="/info/search.aspx?aidlst=4">VC6</a>, <a href="/info/search.aspx?aidlst=23">Win2K</a>, <a href="/info/search.aspx?aidlst=24">WinXP</a>,<br><a href="/info/search.aspx?aidlst=26">Win2003</a>, <a href="/info/search.aspx?aidlst=118">Dev</a>, <a href="/info/search.aspx?aidlst=130">COM</a></span><acronym id="ctl00_TitleArea_InfoBox_TagsList_HiddenTags" title="plus: Intermediate">, +</acronym> 

	
	
</span>

		</td>
	</tr>
	</table>
</div>	
	</div>

	
	<h1 id="ctl00_TitleArea_ArticleTitle">A Word add-in to syntax highlight selected text</h1>

	
	<div class="author">
		By <b><a href="/script/Membership/View.aspx?mid=246471">sswater shi</a></b> | 
		2 Feb 2007 
		

		
		
	</div>

	
	<div class="abstract"><span id="ctl00_TitleArea_ArticleDescr">A Word addin to syntax highlight selected text. The toolbar is permanent, with a transparent button icon.</span></div>
</div>



					

				</div>

				<div id="ctl00_HeadSide" class="header-sidebar">
					<div class="align-right" style="height:24px">
						


&nbsp;










					</div>

					

<div class="bold pad-top">See Also</div>
<ul class="outdent small-text" style="margin-left:5px">
	<li><a id="ctl00_SeeAlso_LikeThis" href="/info/search.aspx?artkw=A+Word+addin++syntax+highlight+selected+text">Articles like this</a></li>
	<li><a id="ctl00_SeeAlso_ByAuthor" href="/script/Articles/MemberArticles.aspx?amid=246471">Articles by this author</a></li>
</ul>

				</div>

			</div>
			

			
			<div id="ctl00_Nav" class="container-nav">
				<div id="ctl00_TabContainer" class="tabs container">

					
					<div class="float-right action-links"> 
						<a id="ctl00_ActionLinks_PrintLnk" class="tooltip" href="/KB/COM/wordhighlight.aspx?display=Print">
	<img src="http://s.codeproject.com/script/Content/Images/print.gif" 
		width="24px" height="24px" style="vertical-align:middle;border:0">
	<div class="speech-bubble-container-up">
		<div class="speech-bubble-up">Print Article</div>
		<div class="speech-bubble-pointer-up">
			<div class="speech-bubble-pointer-up-inner"></div>
		</div>
	</div>
</a>

<iframe id="ctl00_ActionLinks_AddTo_LikeBtn" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:47px; height:23px;vertical-align:bottom;" allowTransparency="true" src="http://www.facebook.com/plugins/like.php?href=%2fKB%2fCOM%2fwordhighlight.aspx&amp;amp;layout=button_count&amp;amp;show_faces=false&amp;amp;width=45&amp;amp;action=like&amp;amp;colorscheme=light&amp;amp;height=21">
</iframe><span id="SBI"><img src="http://s.codeproject.com/images/share_drop16.png" id="ctl00_ActionLinks_AddTo_Img" width="14" height="23" alt="add" style="vertical-align:bottom" />
</span>
<div id="ATD" class="list-socialbookmark"></div> 

 

<span class="tooltip">
	 
	<div class="speech-bubble-container-up">
		<div class="speech-bubble-up">Add to your CodeProject bookmarks</div>
		<div class="speech-bubble-pointer-up">
			<div class="speech-bubble-pointer-up-inner"></div>
		</div>
	</div>
</span>

<a href="#_comments" class="tooltip">
	
	<img src="http://s.codeproject.com/script/Content/Images/discuss.gif" 
		width="24px" height="24px" alt="Discuss" style="vertical-align:middle;border:0" />
	<div class="speech-bubble-container-up">
		<div class="speech-bubble-up">Discuss this article</div>
		<div class="speech-bubble-pointer-up">
			<div class="speech-bubble-pointer-up-inner"></div>
		</div>
	</div>
</a>
<span id="ctl00_ActionLinks_cmtcnt" class="subdue small-text align-middle" style="margin-left:-4px">23</span>

<a id="ctl00_ActionLinks_BrokenLnk" class="tooltip" href="/script/Articles/Report.aspx?aid=14160">
	<img src="http://s.codeproject.com/script/Content/Images/report.gif"
		width="24px" height="24px" alt="Broken Article?" style="vertical-align:middle;border:0" />
	<div class="speech-bubble-container-up" style="width:140px">
		<div class="speech-bubble-up">Report this article as inappropriate</div>
		<div class="speech-bubble-pointer-up">
			<div class="speech-bubble-pointer-up-inner"></div>
		</div>
	</div>
</a>
					</div>

					<div class="float-left">
						
						

<div class="float-left"><table cellpadding="0" cellspacing="0"><tr>
	<td class="tab-selected">Article</td><td class="tab-unselected"><a href="/script/Articles/ViewDownloads.aspx?aid=14160">Browse Code</a></td><td class="tab-unselected"><a href="/script/Articles/Statistics.aspx?aid=14160">Stats</a></td><td class="tab-unselected"><a href="/script/Articles/ListVersions.aspx?aid=14160">Revisions</a></td>
</tr></table></div>	


						
						<div class="float-left" style="margin-left:15px">
							<div id="ctl00_CurRat" class="tooltip" name="CurRat_14160">
								
<table cellpadding="0" cellspacing="0" class="small-text">
<tr>
	
	<td class="nowrap">
		<div style="height:24px;width:120px;position:relative;">
	<table border="0" cellpadding="0" cellspacing="0" class="rating-bar-stars">
		<tr>
			<td width="113px" height="24px" class="filled"></td>
			<td width="7px" height="24px"></td>
		</tr>
	</table>
	<img src="/script/Ratings/Images/stars_orange.gif" style="position:absolute;top:0;left:0;z-index:10;" width="120" height="24" />
</div>

		
	</td>
	
	<td id="ctl00_ArticleRating_VR" class="nowrap">
		&nbsp;<span id="ctl00_ArticleRating_VotesR">&nbsp;4.74 (9 votes)</span>
		
	</td>

</tr>

</table>

								<div id="ctl00_RB" class="speech-bubble-container-up">
									<div class="speech-bubble-up" style="width:150px !important">
										            
<div>
<table class="feature" title="Voting Distribution. Recent data only" cellpadding="0" cellspacing="0"><tr><td class="chart-column"><img src="http://s.codeproject.com/Images/t.gif" width="16px" height="1px" border="0px" alt="" title="" /><br /><span title="0 votes">1</span></td>
<td class="chart-column"><img src="http://s.codeproject.com/Images/t.gif" width="16px" height="1px" border="0px" alt="" title="" /><br /><span title="0 votes">2</span></td>
<td class="chart-column"><img src="http://s.codeproject.com/Images/t.gif" width="16px" height="1px" border="0px" alt="" title="" /><br /><span title="0 votes">3</span></td>
<td class="chart-column"><img src="/script/Ratings/Images/pollcol.gif" width="16px" height="14px" border="0px" alt="2 votes, 22.2%" title="2 votes, 22.2%" /><br /><span title="2 votes">4</span></td>
<td class="chart-column"><img src="/script/Ratings/Images/pollcol.gif" width="16px" height="50px" border="0px" alt="7 votes, 77.8%" title="7 votes, 77.8%" /><br /><span title="7 votes">5</span></td>
</tr></table>
</div>




									</div>
									<div class="speech-bubble-pointer-up">
										<div class="speech-bubble-pointer-up-inner"></div>
									</div>
								</div>
							</div>
						</div>

					</div>

				</div>

				<div id="ctl00_HeadSideFoot" class="tabs-sidebar">
					<div>Sponsored Links</div>
				</div>
			</div>
			

			
			<div class="container-text">

				<div id="AT" class="text">
					
					
					
					

								
			
					<form name="aspnetForm" method="post" action="/KB/COM/wordhighlight.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKMTAyMTMzODg1Ng9kFgJmD2QWAgIED2QWCAIPD2QWAgIBD2QWBmYPDxYCHgtOYXZpZ2F0ZVVybAUyL3NjcmlwdC9BcnRpY2xlcy9BZG1pbi9FZGl0b3JDaG9pY2UuYXNweD9haWQ9MTQxNjBkZAICDw8WAh8ABTgvc2NyaXB0L0F3YXJkcy9BZG1pbi9Bd2FyZE9iamVjdC5hc3B4P29iaWQ9MTQxNjAmb2J0aWQ9MmRkAgoPDxYCHwAFLy9zY3JpcHQvQXJ0aWNsZXMvQWRtaW4vUXVldWVFZGl0LmFzcHg/YWlkPTE0MTYwZGQCEQ9kFgICAQ9kFgICAQ9kFgZmDw8WAh8ABSgvS0IvQ09NL3dvcmRoaWdobGlnaHQuYXNweD9kaXNwbGF5PVByaW50ZGQCBA8WAh4JaW5uZXJodG1sBQIyM2QCBQ8PFgIfAAUmL3NjcmlwdC9BcnRpY2xlcy9SZXBvcnQuYXNweD9haWQ9MTQxNjBkZAITD2QWAgIJD2QWCAIDDxYCHgZhY3Rpb24FGi9LQi9DT00vd29yZGhpZ2hsaWdodC5hc3B4FgQCAw9kFgICAg9kFgICAQ8QZGQWAGQCCQ8WAh4LXyFJdGVtQ291bnQCAWQCCw8PFgIfAAUaL0tCL0NPTS93b3JkaGlnaGxpZ2h0LmFzcHhkZAIRDxYCHgRUZXh0BQoyIEZlYiAyMDA3ZAIVDxYCHwQFHUNvcHlyaWdodCAyMDA2IGJ5IHNzd2F0ZXIgc2hpZAIVD2QWAgIFDw8WAh4HVmlzaWJsZWhkZGRmYoAqWFWlmRvZMeaSTla2Ntm+2A==" />
</div>


						<!-- Article Text Start -->
						<div id="contentdiv">
						

<!-- Article Starts -->


<ul class="download">
  <li><a href="wordhighlight/Addin_src.zip">Download 
  source codes - 30.2 Kb</a> 
  </li><li><a href="wordhighlight/Addin_binary.zip">Download 
  binary files - 122 Kb</a> 
  </li><li><a href="wordhighlight/Addin_setup.zip">Download 
  setup package - 179 Kb</a> </li>
    <li><a href="wordhighlight/lib_syntax.zip">
    Download static library lib_syntax.lib - 25 Kb</a></li></ul>
<p><img width="568" height="473" alt="Sample Image - Addin_Shot.gif" src="wordhighlight/Addin_Shot.gif" /></p>
<h2>Introduction</h2>
<p>The Syntax Highlight add-in is a COM add-in for Microsoft Word. Through a COM 
add-in, we can add a menu item or toolbar button onto Word, implementing special 
functions which we need.</p>
<p>The add-in on this page can change the color or background color of a 
selected text. How to do this is not fixed. Anyone can define a new rule for 
changing color, by implementing the functions which are declared in the 
interface header file. This add-in provides an open method to operate with text 
in Word. If you are interested in parsing text, this add-in can help you parse 
text too.</p>
<p>This software consists of a main module (<em>sntxaddn.dll</em>) and a set of 
highlight rules.</p>
<h2>References</h2>
<p>Basically, as an add-in, the principle of this software is the same as the 
one in: <a href="outlookaddin.asp" target="_blank">Building an Office2K COM add-in with VC++/ATL</a>, which is an 
add-in for Outlook.</p>
<p>So, this article will mostly describe the special points of this add-in 
itself.</p>
<h2>Interesting &amp; Special Points</h2>
<h3>1. Permanent, <em>not</em> temporary CommandBar</h3>
<p>A temporary command bar will be removed when Word is closed, and will be 
re-created when Word is opened. If you drag the newly created command bar to a 
position, the position will be lost after Word is re-opened. Instead, a 
permanent command bar will <strong>not</strong> be removed when Word is closed.</p>
<p>But a new problem is emitted: &quot;When to remove the command bar if the user 
want to uninstalls it?&quot; My solution: &quot;Remove the command bar in 
<code>DllUnregisterServer</code>.&quot;</p>
<h5>Create permanent, <em>not</em> temporary CommandBar:</h5>
<pre lang="C++">CComPtr <span class="code-keyword">&lt;</span>_CommandBars<span class="code-keyword">&gt;</span> spCmdBars = wordApp-<span class="code-keyword">&gt;</span>
    GetCommandBars();
CComPtr <span class="code-keyword">&lt;</span>CommandBar<span class="code-keyword">&gt;</span> spNewCmdBar = NULL;
 
<span class="code-comment">//</span><span class="code-comment"> attach command bar if already exists
</span>
HRESULT hr = spCmdBars-<span class="code-keyword">&gt;</span>get_Item(_variant_t(RSTR(
    IDS_SYNTAX_BAR)), &amp;spNewCmdBar);
 
<span class="code-keyword">if</span>( FAILED(hr) || spNewCmdBar == NULL )
{
    <span class="code-comment">//</span><span class="code-comment"> New Create if not exists
</span>
    CComVariant vName (RSTR(IDS_SYNTAX_BAR));
    CComVariant vPos  (msoBarFloating);
    CComVariant vTemp (VARIANT_FALSE); <span class="code-comment">//</span><span class="code-comment">menu is NOT temporary 
</span>
    CComVariant vEmpty(DISP_E_PARAMNOTFOUND, VT_ERROR);
    spNewCmdBar = spCmdBars-<span class="code-keyword">&gt;</span>Add(vName, vPos, vEmpty, vTemp);
}</pre>
<h5>Attach old button if exists:</h5><pre lang="C++"><span class="code-comment">//</span><span class="code-comment"> attach buttons
</span>
<span class="code-keyword">int</span> btncnt = spBarControls-<span class="code-keyword">&gt;</span>GetCount();
<span class="code-keyword">for</span>(i=btncnt; i<span class="code-keyword">&gt;</span>=1; i--)
{
    CComPtr <span class="code-keyword">&lt;</span>CommandBarControl<span class="code-keyword">&gt;</span> spNewBar = 
       spBarControls-<span class="code-keyword">&gt;</span>GetItem(_variant_t((<span class="code-keyword">long</span>)i));
    CComQIPtr <span class="code-keyword">&lt;</span>_CommandBarButton<span class="code-keyword">&gt;</span> spButton( spNewBar );
    _bstr_t tag = spButton-<span class="code-keyword">&gt;</span>GetTag();
    CSyntaxModule * pSyntax = NULL;
 
    <span class="code-keyword">for</span>(<span class="code-keyword">int</span> j=0; j<span class="code-keyword">&lt;</span>MAX_BUTTONS; j++)
    {
        <span class="code-keyword">if</span>( m_pSyntax[j] == NULL )
            <span class="code-keyword">break</span>;
 
        <span class="code-keyword">if</span>( m_pSyntax[j]-<span class="code-keyword">&gt;</span>m_szSyntaxName == tag )
        {
            pSyntax = m_pSyntax[j];
            <span class="code-keyword">break</span>;
        }
    }
 
    <span class="code-keyword">if</span>( pSyntax != NULL )
    {
        <span class="code-comment">//</span><span class="code-comment"> keep reference to button disp
</span>
        m_spButtons[nAttachIndex ++] = spButton;
        DispEventAdvise(nAttachIndex, (IDispatch*)spButton);
        pSyntax-<span class="code-keyword">&gt;</span>m_bAttached = TRUE;
    }
    <span class="code-keyword">else</span>
    {
        spButton-<span class="code-keyword">&gt;</span>Delete();
        bUpdated = TRUE;
    }
}</pre>
<h5>Remove command bar in 'DllUnregisterServer':</h5><pre lang="C++"><span class="code-comment">//</span><span class="code-comment">
</span>
<span class="code-comment">//</span><span class="code-comment"> Attach to Running Word instance
</span>
<span class="code-comment">//</span><span class="code-comment"> or Create New Word Application instance
</span>
<span class="code-comment">//</span><span class="code-comment">
</span>
CComPtr <span class="code-keyword">&lt;</span>_Application<span class="code-keyword">&gt;</span> CWordSntxAddnApp::AttachRunningWord()
{
    HRESULT hr;
    CLSID   clsid;
    hr = ::CLSIDFromProgID(L<span class="code-string">&quot;</span><span class="code-string">Word.Application&quot;</span>, &amp;clsid);
 
    <span class="code-keyword">if</span>(FAILED(hr))
    {
        <span class="code-keyword">return</span> NULL;
    }
 
    IUnknown  * pUnknown = NULL;
    hr = ::GetActiveObject(clsid, NULL, &amp;pUnknown);
    <span class="code-keyword">if</span>( !FAILED(hr) )
    {
        <span class="code-keyword">return</span> CComQIPtr <span class="code-keyword">&lt;</span>_Application<span class="code-keyword">&gt;</span> ( pUnknown );
    }
    <span class="code-keyword">else</span>
    {
        COleDispatchDriver ddrv;
        ddrv.CreateDispatch(clsid);
        <span class="code-keyword">return</span> CComQIPtr <span class="code-keyword">&lt;</span>_Application<span class="code-keyword">&gt;</span> (ddrv.m_lpDispatch);
    }
}
VOID CWordSntxAddn::RemoveCommandBar(CComPtr <span class="code-keyword">&lt;</span>_Application<span class="code-keyword">&gt;</span> &amp; wordApp)
{
    CComPtr <span class="code-keyword">&lt;</span>_CommandBars<span class="code-keyword">&gt;</span> spCmdBars = wordApp-<span class="code-keyword">&gt;</span>GetCommandBars();
    CComPtr <span class="code-keyword">&lt;</span>CommandBar<span class="code-keyword">&gt;</span> spSyntaxCmdBar = NULL;
 
    HRESULT hr = 
            spCmdBars-<span class="code-keyword">&gt;</span>get_Item(_variant_t(RSTR(IDS_SYNTAX_BAR)), 
            &amp;spSyntaxCmdBar);
    <span class="code-keyword">if</span>( !FAILED(hr) &amp;&amp; spSyntaxCmdBar != NULL )
    {
        spSyntaxCmdBar-<span class="code-keyword">&gt;</span>Delete();
 
        <span class="code-comment">//</span><span class="code-comment"> Save
</span>
        CComQIPtr <span class="code-keyword">&lt;</span>Template<span class="code-keyword">&gt;</span> custom( wordApp-<span class="code-keyword">&gt;</span>GetCustomizationContext() );
        custom-<span class="code-keyword">&gt;</span>Save();
    }
}</pre>
<h3>2. Transparent button icon</h3>
<p>In order to be compatible with Office 2000, I used 'PasteFace' to transfer a 
button icon. According to <a href="http://support.microsoft.com/kb/288771">Microsoft documentation</a>, I was 
going to use &quot;Toolbar Button Face&quot; and &quot;Toolbar Button Mask&quot; as the clipboard 
format names.</p>
<p>But I met a problem, 'PasteFace' failed to transfer the transparent button 
icon if the Office software is not the English version. Indeed, the clipboard 
format name should be localized if Office software is the German or Chinese 
version etc.</p>
<p>I asked in many forums, but nobody was able to say anything about it. 
Afterwards, I found a way to determine the format names by myself.</p><pre lang="C++"><span class="code-comment">//</span><span class="code-comment"> to determine localized 'format name'
</span>
::OpenClipboard(NULL);
::EmptyClipboard();
::SetClipboardData(CF_BITMAP, 
     ::LoadBitmap(_Module.GetResourceInstance(), 
     MAKEINTRESOURCE(IDB_HIGHLIGHT)));
::CloseClipboard();
 
spButton-<span class="code-keyword">&gt;</span>PasteFace();
spButton-<span class="code-keyword">&gt;</span>CopyFace();
 
<span class="code-comment">//</span><span class="code-comment"> Init
</span>
_tcscpy(m_szFaceFormatName, _T(<span class="code-string">&quot;</span><span class="code-string">Toolbar Button Face&quot;</span>));
_tcscpy(m_szMaskFormatName, _T(<span class="code-string">&quot;</span><span class="code-string">Toolbar Button Mask&quot;</span>));
 
<span class="code-comment">//</span><span class="code-comment"> loop
</span>
::OpenClipboard(NULL);
 
UINT  format = <span class="code-digit">0</span>, n = <span class="code-digit">0</span>, fmtsize[<span class="code-digit">2</span>] = {<span class="code-digit">0</span>};
TCHAR fmtnames[<span class="code-digit">2</span>][<span class="code-digit">100</span>] = {<span class="code-digit">0</span>};
 
<span class="code-keyword">while</span>( (format = ::EnumClipboardFormats(format)) != <span class="code-digit">0</span> )
{
    <span class="code-keyword">if</span>( format <span class="code-keyword">&gt;</span> <span class="code-digit">17</span> &amp;&amp; GetClipboardFormatName(format, 
                              fmtnames[n], <span class="code-digit">100</span>) != <span class="code-digit">0</span> )
    {
        fmtsize[n++] = ::GlobalSize(::GetClipboardData(format));
        <span class="code-keyword">if</span>( n <span class="code-keyword">&gt;</span>= <span class="code-digit">2</span> ) <span class="code-keyword">break</span>;
    }
}
 
<span class="code-keyword">if</span>( fmtsize[<span class="code-digit">0</span>] <span class="code-keyword">&gt;</span> fmtsize[<span class="code-digit">1</span>] )
{
    <span class="code-keyword">if</span>( fmtnames[<span class="code-digit">0</span>][<span class="code-digit">0</span>] )
       _tcscpy(m_szFaceFormatName, fmtnames[<span class="code-digit">0</span>]);
    <span class="code-keyword">if</span>( fmtnames[<span class="code-digit">1</span>][<span class="code-digit">0</span>] )
       _tcscpy(m_szMaskFormatName, fmtnames[<span class="code-digit">1</span>]);
}
<span class="code-keyword">else</span>
{
    <span class="code-keyword">if</span>( fmtnames[<span class="code-digit">1</span>][<span class="code-digit">0</span>] )
        _tcscpy(m_szFaceFormatName, fmtnames[<span class="code-digit">1</span>]);
    <span class="code-keyword">if</span>( fmtnames[<span class="code-digit">0</span>][<span class="code-digit">0</span>] )
        _tcscpy(m_szMaskFormatName, fmtnames[<span class="code-digit">0</span>]);
}
 
::CloseClipboard();</pre>
<h3>3. Backup and restore clipboard data around using 'PasteFace'</h3>
<p>The 'CopyFace' and 'PasteFace' operations will destroy any old clipboard 
data, which is copied into the clipboard before Word is opened, and the old 
clipboard data may be what you are going to paste into Word.</p>
<p>Then, backup the old clipboard data before the toolbar button's Create 
process:</p><pre lang="C++"><span class="code-keyword">if</span>( ! ::OpenClipboard(NULL) )
    <span class="code-keyword">return</span> FALSE;
 
UINT format = <span class="code-digit">0</span>;
<span class="code-keyword">while</span>( (format = ::EnumClipboardFormats(format)) != <span class="code-digit">0</span> )
{
    ClipboardData data;
    data.m_nFormat = format;

    <span class="code-comment">//</span><span class="code-comment"> skip some formats
</span>
    <span class="code-keyword">if</span>( format == CF_BITMAP || format == CF_METAFILEPICT ||
        format == CF_PALETTE || format == CF_OWNERDISPLAY ||
        format == CF_DSPMETAFILEPICT || format == CF_DSPBITMAP ||
        ( format <span class="code-keyword">&gt;</span>= CF_PRIVATEFIRST &amp;&amp; format <span class="code-keyword">&lt;</span>= CF_PRIVATELAST ) )
    {
        <span class="code-keyword">continue</span>;
    }

    <span class="code-comment">//</span><span class="code-comment"> get format name
</span>
    <span class="code-keyword">if</span>( format <span class="code-keyword">&lt;</span>= <span class="code-digit">14</span> )
        data.m_szFormatName[<span class="code-digit">0</span>] = <span class="code-digit">0</span>;
    <span class="code-keyword">else</span> <span class="code-keyword">if</span>( GetClipboardFormatName(format, 
                  data.m_szFormatName, <span class="code-digit">100</span>) == <span class="code-digit">0</span> )
        data.m_szFormatName[<span class="code-digit">0</span>] = <span class="code-digit">0</span>;

    <span class="code-comment">//</span><span class="code-comment"> get handle
</span>
    HANDLE hMem = ::GetClipboardData( format );
    <span class="code-keyword">if</span>( hMem == NULL )
        <span class="code-keyword">continue</span>;
 
    <span class="code-comment">//</span><span class="code-comment"> copy handle
</span>
    <span class="code-keyword">switch</span>( format )
    {
    <span class="code-keyword">case</span> CF_ENHMETAFILE:
    <span class="code-keyword">case</span> CF_DSPENHMETAFILE:
        data.m_hData = 
            ::CopyMetaFile((HMETAFILE)hMem, NULL);
        <span class="code-keyword">break</span>;
 
    <span class="code-keyword">default</span>:
        {
            <span class="code-keyword">int</span>    size = ::GlobalSize(hMem);
            LPVOID pMem = ::GlobalLock( hMem );
 
            data.m_hData   = ::GlobalAlloc( GMEM_MOVEABLE | 
                                            GMEM_DDESHARE, size );
            LPVOID pNewMem = ::GlobalLock( data.m_hData );
 
            memcpy(pNewMem, pMem, size);
 
            ::GlobalUnlock(hMem);
            ::GlobalUnlock(data.m_hData);
        }
    }
 
    m_lstData.AddTail(data);
}
::CloseClipboard(); </pre>
<p>Restore the clipboard after the toolbar button's creation is completed:</p><pre lang="C++"><span class="code-keyword">if</span>( ! ::OpenClipboard(NULL) )
    <span class="code-keyword">return</span> FALSE;
 
::EmptyClipboard();
 
POSITION pos = m_lstData.GetHeadPosition();
<span class="code-keyword">while</span>( pos != NULL )
{
    ClipboardData &amp; data = m_lstData.GetNext( pos );
 
    UINT format = data.m_nFormat;
 
    <span class="code-keyword">if</span>( data.m_szFormatName[<span class="code-digit">0</span>] != <span class="code-digit">0</span> )
    {
        UINT u = RegisterClipboardFormat( data.m_szFormatName );
        <span class="code-keyword">if</span>( u <span class="code-keyword">&gt;</span> <span class="code-digit">0</span> ) format = u;
    }
 
    ::SetClipboardData( format, data.m_hData );
}
 
::CloseClipboard(); </pre>
<h3>4. Interface of the custom syntax rule</h3>
<p>This add-in can load custom rules dynamically. The interface header file 
is:</p><pre lang="C++"><span class="code-comment">//</span><span class="code-comment"> API
</span>
<span class="code-preprocessor">#define</span> SYNTAX_MOD_API <span class="code-keyword">__declspec</span>(<span class="code-keyword">dllexport</span>)
 
<span class="code-comment">//</span><span class="code-comment"> extern &quot;C&quot;
</span>
#ifdef __cplusplus
    <span class="code-keyword">extern</span> <span class="code-string">&quot;</span><span class="code-string">C&quot;</span> {
<span class="code-preprocessor">#endif</span>
 
<span class="code-comment">//</span><span class="code-comment"> Caption
</span>
LPCSTR SYNTAX_MOD_API GetCaption();
 
<span class="code-comment">//</span><span class="code-comment"> Tooltip ( Optional )
</span>
LPCSTR SYNTAX_MOD_API GetTooltip();
 
<span class="code-comment">//</span><span class="code-comment"> Button Face ( Optional )
</span>
HBITMAP SYNTAX_MOD_API GetBtnFace();
 
<span class="code-comment">//</span><span class="code-comment"> Parse
</span>
VOID SYNTAX_MOD_API Parse(LPWSTR text, INT len);
 
<span class="code-comment">//</span><span class="code-comment"> Nextpos
</span>
BOOL SYNTAX_MOD_API GetNextPos(INT &amp; pos, INT &amp; len);
 
<span class="code-comment">//</span><span class="code-comment"> Color
</span>
BOOL SYNTAX_MOD_API GetColor(INT &amp; color);
 
<span class="code-comment">//</span><span class="code-comment"> Background Color ( Optional )
</span>
BOOL SYNTAX_MOD_API GetBgColor(INT &amp; bgcolor);

#ifdef __cplusplus
    }
<span class="code-preprocessor">#endif</span></pre>
<h2>How to implement 'Syntax Rule' easily</h2>
<p>Each 'syntax rule' is a single dll file which implements those API's above.</p>
<p>I have provided a 'static library' (lib_syntax.lib) to help you to write 'syntax rule'. This 
'static library' has implemented the key API's: 'Parse', 'GetNextPos', and 'GetColor'. 
Everything you need to do is to provide a 'regular expression pattern' and a 
'color definition map'. For example:</p>
<pre lang="C++"><span class="code-comment">//</span><span class="code-comment"> regular expression pattern
</span>
LPCWSTR pattern = L<span class="code-string">&quot;</span><span class="code-string">(?&lt;upper&gt;[A-Z]+)|(?&lt;lower&gt;[a-z]+)|(?&lt;number&gt;[0-9]+)&quot;</span>;

<span class="code-comment">//</span><span class="code-comment"> color
</span>
ColorMap map[] =
{
    { L<span class="code-string">&quot;</span><span class="code-string">upper&quot;</span> , RGB(0xff, <span class="code-digit">0</span>, <span class="code-digit">0</span>) },
    { L<span class="code-string">&quot;</span><span class="code-string">lower&quot;</span> , RGB(<span class="code-digit">0</span>, 0xff, <span class="code-digit">0</span>) },
    { L<span class="code-string">&quot;</span><span class="code-string">number&quot;</span>, RGB(<span class="code-digit">0</span>, <span class="code-digit">0</span>, 0xff) },
};

<span class="code-comment">//</span><span class="code-comment"> entrance
</span>
BOOL APIENTRY DllMain( HANDLE hModule, 
                       DWORD ul_reason_for_call, 
                       LPVOID lpReserved
)
{
    <span class="code-keyword">if</span>( ul_reason_for_call == DLL_PROCESS_ATTACH )
    {
        <span class="code-comment">//</span><span class="code-comment"> when initialization
</span>
        InitSyntax(
            pattern,
            <span class="code-digit">0</span>,
            map,
            <span class="code-keyword">sizeof</span>(map)/sizeof(ColorMap)
        );
    }

    <span class="code-keyword">return</span> TRUE;
}</pre>
<p>The main point about the 'regular expression pattern' is that: I used 'Named 
group' of 'regular expression'.</p>
<p>DEELX regular expression engine for C++ supports 'Named group', so I used 
DEELX in the lib_syntax.lib. DEELX regular expression engine is discussed at
<a href="http://www.codeproject.com/article.asp?tag=19352982551739069">
codeproject.com</a>, and introduced at DEELX homepage:
<a href="http://www.regexlab.com/deelx/">http://www.regexlab.com/deelx/</a> .</p>
<p>Please pay attention to the 'run-time library' of your dll project and the 
lib_syntax.lib library. They must be the same before they can be linked 
successfully.</p>
<h2>References and Acknowledgements</h2>
<ul>
  <li><a href="http://www.regexlab.com/highlight/" target="_blank">Homepage</a> - 
  the provenance of this add-in, I'm the author. 
  </li><li><a href="outlookaddin.asp" target="_blank">Create an Add-in</a> 
  </li><li><a href="http://www.daveswebsite.com/articles/article1/index.shtml" target="_blank">Transparent Button Icon in VC++</a> 
  </li><li><a href="http://support.microsoft.com/kb/288771" target="_blank">Transparent 
  Button Icon in VB</a> 
  </li><li><a href="http://www.codeproject.com/clipboard/cbbackup.asp">Backup 
  Clipboard Data</a> 
  </li><li><a href="http://www.codeguru.com/bitmap/ddb_to_dib.shtml" target="_blank">DDB to DIB</a> </li></ul>








						</div>
						<!-- Article Text End -->

						
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx">The Code Project Open License (CPOL)</a></p></div>
						

						
						<h2 id="ctl00_AboutHeading">About the Author</h2>

						<div class="float-right">
						<div class="lqm_ad" width="300px" height="250px" lqm_channel="1" lqm_publisher="495" lqm_zone="77" lqm_format="6" lqm_country='IR' lqm_tags='VC6,Win2K,WinXP,Win2003,Dev,COM,Intermediate'></div>
						</div>

						
						
   
<table cellpadding="0" cellspacing="5" border="0">
<tr valign="top">
<td id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable" valign="top" style="width:155px;">
	<b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" href="/Members/sswater-shi">sswater shi</a></b><br /><br />
	<center><img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" src="/script/Membership/ProfileImages/{FD4238C4-A829-4E6C-A1CB-2DB44F0C3306}.jpg" style="border-width:0px;" /></center>

	<div class="small-text">
		<span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle">Software Developer (Senior)</span><br />
		<span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span><br />
		<span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation"><img src="/script/Geo/Images/CN.gif" alt="China" width="16px" height="11px" /> China</span><br />
		<br />
		<span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType">Member</span><br />
		

		
	</div>
</td>

<td>
	Begin coding from basic, since 1994. Interested in coding and database and website constructing.<br />My website: <a target="_blank" href="http://www.regexlab.com/">http://www.regexlab.com/</a> - Regular Expression Laboratory<br />The easiest regex engine: <a target="_blank" href="http://www.regexlab.com/deelx/">http://www.regexlab.com/deelx/</a><br />	
</td>
</tr>
</table><br />
						
						

						<div class="clearfix"></div>

						
						<div id="ctl00_RateArticleRow" class="clearfix voting-bar">
						<div class="column8_1" style="padding-top:8px"> <a href="#_top">Article Top</a></div>
						<div class="column8_7 align-right"><div id="ctl00_RateArticle_RateItemWrapper" class="container-rating small-text" name="RateItem_14160">

	<table width="100%" cellpadding="0" cellspacing="0" small-text>
	<tr>
		
	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tr valign="middle">
				<td id="ctl00_RateArticle_SignIn" nowrap="nowrap">
					<a href="#SignUp">Sign Up</a> to vote for this article
				</td>

				
				
				
				
				
			</tr>
			</table>
			<span id="ctl00_RateArticle_ErrorMessage" class="error"></span>
		</td>
	</tr>
	</table>
	<div class="hover-container">
		<div id="ctl00_RateArticle_RCD" class="rating-comment align-left float-right">
			Add a reason or comment to your vote: <a href="#" id="clear-rate_ctl00_RateArticle_RCD" title="close">x</a><br />
			<textarea class="RateComment" rows="5" cols="60" style="width:98%;"></textarea>
		</div>
	</div>
</div>
</div>
						</div>
						

					</form>

					
					<div style="margin:auto;padding:0px 10px;white-space:nowrap;overflow:hidden;width:460px;height:60px">		  
						<div class="lqm_ad" width="468px" height="60px" lqm_channel="1" lqm_publisher="495" lqm_zone="77" lqm_format="1" lqm_country='IR' lqm_tags='VC6,Win2K,WinXP,Win2003,Dev,COM,Intermediate'></div>
					</div>
					

					
					
					<h2>Comments and Discussions</h2>
					<a name="_comments"></a><!-- Forum Start -->
<div id="_MessageBoard" onclick="return SwitchMessage(event, null)">
<table id="ForumTable" class="box forum" cellpadding="0" cellspacing="0">
<tr>
<td class="forum-header1 highlight"><b>You must <a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx%3ffid%3d307468%26df%3d90%26mpp%3d25%26noise%3d3%26sort%3dPosition%26view%3dQuick">Sign In</a> to use this message board.</b></td>
</tr><tr>
<td><table width="100%" border="0" cellpadding="3px" cellspacing="0">
<tr class="forum-header1">
<td style="white-space:nowrap;"><img src="http://s.codeproject.com/Images/info-16.gif" alt="FAQ" style="border-width:0;width:16px;height:16px;vertical-align:middle;" />&nbsp;<a href="/KB/FAQs/MessageBoardsFAQ.aspx"><b>FAQ</b></a>&nbsp;</td><td colspan="2" style="white-space:nowrap;text-align:right;"><form action="/script/Forums/Search.aspx?fid=0" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="307468" /><input type="text" class="Frm_Input" name="kw" />&nbsp;<input type="submit" value="Search" name="FrmSrch" class="button" />
</form></td>
</tr><tr class="forum-header2">
<td colspan="3" style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?floc=%2fKB%2fCOM%2fwordhighlight.aspx&amp;fid=307468&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="307468" /><input type="hidden" name="currentQS" value="?floc=%2fKB%2fCOM%2fwordhighlight.aspx&amp;fid=307468&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick" /><input type="hidden" name="floc" value="/KB/COM/wordhighlight.aspx" />Noise Tolerance<select size="1" class="Frm_DropDown" name="noise">
<option value="1">Very High</option><option value="2">High</option><option selected value="3">Medium</option><option value="4">Low</option><option value="5">Very Low</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="Frm_DropDown" name="view">
<option selected value="Quick">Normal</option><option value="Topic">Expand Posts only</option><option value="Expanded">Expand Posts & Replies</option><option value="Thread">Thread View</option><option value="Normal">No Javascript</option><option value="Preview">No JS + Preview</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="Frm_DropDown" name="mpp">
<option value="10">10</option><option selected value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button" />
</form>
</div></td>
</tr>
</table></td>
</tr><tr>
<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
<tr class="forum-navbar">
<td>&nbsp;</td><td>Msgs 1 to 23 of 23 (Total in Forum: 23) (<a href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick">Refresh</a>)</td><td style="text-align:right;white-space:nowrap;"><span class="toolbar">First</span><span class="toolbar">Prev</span><span class="toolbar">Next</span></td>
</tr>
</table></td>
</tr><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background">
<tr>
<td><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="5px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd Rt HdUnSel " id="F3568613_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="16px" class="Frm_MsgIndent"><a name="xx3568613xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_general.gif" alt="General" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="3568613" href="/Messages/3568613/Does-it-support-Office-2007.aspx">Does it support Office 2007?</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=5467">jeasonzhao</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">22:23 17 Aug '10 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F3568613_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:16px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="16px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Hi:<br />Does it support Word 2007 as well?<br /><div class="signature">Please pardon my weak English!</div><br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3568613" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/3568613/Does-it-support-Office-2007.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF3568613" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd HdUnSel " id="F3569224_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="34px" class="Frm_MsgIndent"><a name="xx3569224xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_general.gif" alt="General" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="3569224" href="/Messages/3569224/Re-Does-it-support-Office-2007.aspx">Re: Does it support Office 2007?</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=246471">sswater shi</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">5:15 18 Aug '10 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F3569224_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:34px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="34px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">I have just tested, it can.<br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3568613" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/3569224/Re-Does-it-support-Office-2007.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF3569224" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="root msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd Rt HdUnSel " id="F3005875_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="16px" class="Frm_MsgIndent"><a name="xx3005875xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_general.gif" alt="General" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="3005875" href="/Messages/3005875/_commandbarbutton-Image-problem.aspx">_commandbarbutton Image problem</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=3549723">Member 3549723</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">20:30 15 Apr '09 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F3005875_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:16px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="16px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">IPicture *Ipic = NULL;<br />//Do not use BITMAP resource for it ripped the bitmap file header<br />HRSRC hResInfo = ::FindResource(Inst, (LPTSTR)IDR_XXX, _T("SomeResType"));<br />HGLOBAL hxx = ::LoadResource(Inst, hResInfo);<br />IStream* pIStream = NULL;<br />void* buffer = ::GlobalLock(hxx);<br />DWORD ss = SizeofResource(hInstance, hResInfo);<br />void* buffer2 = ::GlobalAlloc(GPTR, ss);<br />memcpy(buffer2, buffer, ss);<br />GlobalUnlock(hxx);<br />hr = ::CreateStreamOnHGlobal(buffer2, FALSE, &amp;pIStream);<br />hr = ::OleLoadPicture(pIStream, ss, FALSE, IID_IPicture, (LPVOID*)&amp;Ipic);<br />hr = yourCmdButton-&gt;put_Picture((IPictureDisp*)Ipic);<br />GlobalFree(buffer2);<br /><br />In put_Picture i am getting E_UNEXPECTED error.<br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3005875" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/3005875/_commandbarbutton-Image-problem.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF3005875" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="root msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd Rt HdUnSel " id="F3003210_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="16px" class="Frm_MsgIndent"><a name="xx3003210xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_general.gif" alt="General" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="3003210" href="/Messages/3003210/Set-button-Image.aspx">Set button Image</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=3549723">Member 3549723</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">3:26 14 Apr '09 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F3003210_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:16px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="16px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">for button image i am using below code:<br /><br /> HBITMAP hBmp =(HBITMAP)::LoadImage(_Module.GetResourceInstance(),<br />			MAKEINTRESOURCE(IDB_BITMAP1),IMAGE_BITMAP,0,0,LR_LOADMAP3DCOLORS);<br />		<br />		// put bitmap into Clipboard<br />		::OpenClipboard(NULL);<br />		::EmptyClipboard();<br />		::SetClipboardData(CF_BITMAP, (HANDLE)hBmp);<br />		::CloseClipboard();<br />		::DeleteObject(hBmp);<br /><br />..........<br />.........<br />spCmdButton-&gt;PasteFace();<br /><br />I am not interested to use Clipboard.Is there any way by which i can get same thing for office 2000/2003/2007 ?<br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3003210" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/3003210/Set-button-Image.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF3003210" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd HdUnSel " id="F3003378_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="34px" class="Frm_MsgIndent"><a name="xx3003378xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_general.gif" alt="General" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="3003378" href="/Messages/3003378/Re-Set-button-Image.aspx">Re: Set button Image</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=246471">sswater shi</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">5:00 14 Apr '09 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F3003378_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:34px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="34px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">A new way supported since 2003, but not compatible with 2002(xp)/2000. Only PasteFace is supported by old office 2002(xp)/2000. The new way is to use IPicture (I don't remember clearly).<br /><br />So for compatibility, I use PasteFace. To meet the shortfall, I make a backup of clipboard.<br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=3003210" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/3003378/Re-Set-button-Image.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF3003378" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="root msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd LoVote Rt HdUnSel " id="F2667662_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="16px" class="Frm_MsgIndent"><a name="xx2667662xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_answer.gif" alt="Answer" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="2667662" href="/Messages/2667662/Set-image-on-the-button.aspx">Set image on the button</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=73491">Zhefu Zhang</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">19:39 6 Aug '08 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F2667662_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:16px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="16px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">I just came across here and saw your code of pasting image to button THRU clipboard. It seems not a good idea for apparent reason.<br />The following code excerpt shows how to load an image source as the button image:<br /><br />IPicture *Ipic = NULL;<br />//Do not use BITMAP resource for it ripped the bitmap file header<br />HRSRC hResInfo = ::FindResource(Inst, (LPTSTR)IDR_XXX, _T("SomeResType"));<br />HGLOBAL hxx = ::LoadResource(Inst, hResInfo);<br />IStream* pIStream = NULL;<br />void* buffer = ::GlobalLock(hxx);<br />DWORD ss = SizeofResource(hInstance, hResInfo);<br />void* buffer2 = ::GlobalAlloc(GPTR, ss);<br />memcpy(buffer2, buffer, ss);<br />GlobalUnlock(hxx);<br />hr = ::CreateStreamOnHGlobal(buffer2, FALSE, &pIStream);<br />hr = ::OleLoadPicture(pIStream, ss, FALSE, IID_IPicture, (LPVOID*)&Ipic);<br />hr = yourCmdButton-&gt;put_Picture((IPictureDisp*)Ipic);<br />GlobalFree(buffer2);<br /><br />Cheers.<br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2667662" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/2667662/Set-image-on-the-button.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF2667662" style="white-space:nowrap;">2.00/5 (1 vote) </span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd HiVote HdUnSel " id="F2767359_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="34px" class="Frm_MsgIndent"><a name="xx2767359xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_general.gif" alt="General" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="2767359" href="/Messages/2767359/Re-Set-image-on-the-button.aspx">Re: Set image on the button</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=246471">sswater shi</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">0:43 16 Oct '08 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F2767359_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:34px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="34px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">put_Picture is not compatible with Office 2000, it is a new feature of Office 2003.<br />I remember, I'm not so sure. Thank you very much for your advice anyway.<br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2667662" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/2767359/Re-Set-image-on-the-button.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF2767359" style="white-space:nowrap;">5.00/5 (2 votes) </span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd HdUnSel " id="F3004672_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="34px" class="Frm_MsgIndent"><a name="xx3004672xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_general.gif" alt="General" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="3004672" href="/Messages/3004672/Re-Set-image-on-the-button.aspx">Re: Set image on the button</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=3549723">Member 3549723</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">1:56 15 Apr '09 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F3004672_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:34px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="34px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">In this line i am getting E_UNEXPECTED error<br /><br />hr =put_Picture((IPictureDisp*)Ipic);<br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2667662" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/3004672/Re-Set-image-on-the-button.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF3004672" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="root msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd Rt HdUnSel " id="F2151310_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="16px" class="Frm_MsgIndent"><a name="xx2151310xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_question.gif" alt="Question" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="2151310" href="/Messages/2151310/Problem-with-normal-dot.aspx">Problem with normal.dot</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=258247">programvinod</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">0:10 26 Jul '07 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F2151310_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:16px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="16px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Hi, <br />I was trying with my product and had a problem. If you run two instance of winword, when you try to close one instance, it complaints that normal.dot is changed. so save normal.dot. I did a small checking on this and still continueing. I tried to see whether you catching this problem and I found the same problem with your product. <br />http://support.microsoft.com/kb/818953<br />http://msdn2.microsoft.com/en-us/library/aa537165(office.11).aspx#OfficeWord2003Customizing_Design<br />these are some sites which i m reading to fix this problem... Not yet found some fix though...<br /><br />Steps to Reproduce the Behavior<br />1.	Install Authoring Connector for MCMS 2002.<br />2.	Click Start, and then click Run.<br />3.	Open a command prompt, and then type the following at the command prompt to start Word with the /automation switch:<br />winword /automation<br />4.	Repeat steps 2 and 3 to create a second Word instance.<br />5.	Close the Word instance that you created in step 4.<br /><br />This file is in use by another application or user.<br />(C:\...\Normal.dot) <br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2151310" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/2151310/Problem-with-normal-dot.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF2151310" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd HdUnSel " id="F2282989_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="34px" class="Frm_MsgIndent"><a name="xx2282989xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_answer.gif" alt="Answer" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="2282989" href="/Messages/2282989/Re-Problem-with-normal-dot.aspx">Re: Problem with normal.dot</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=1969352">Oren K.</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">4:55 22 Oct '07 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F2282989_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:34px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="34px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">I also had this problem. I solved it by setting the CustomizationContext to another template and setting the "Saved" flag to true (it doesn't save the changes - only clear the dirty flag). <br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2151310" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/2282989/Re-Problem-with-normal-dot.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF2282989" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd HdUnSel " id="F2767373_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="34px" class="Frm_MsgIndent"><a name="xx2767373xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_answer.gif" alt="Answer" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="2767373" href="/Messages/2767373/Re-Problem-with-normal-dot.aspx">Re: Problem with normal.dot</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=246471">sswater shi</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">0:55 16 Oct '08 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F2767373_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:34px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="34px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">You can find this piece of code in my source file:<br /><br />    // Save<br />    CComQIPtr &lt;Template&gt; custom( wordApp-&gt;GetCustomizationContext() );<br />    custom-&gt;Save();<br /><br />(I was not informed by codeproject when you posted this message. My reply may have been useless for you, but I post it for reference.)<br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2151310" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/2767373/Re-Problem-with-normal-dot.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF2767373" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="root msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd Rt HdUnSel " id="F2149650_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="16px" class="Frm_MsgIndent"><a name="xx2149650xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_general.gif" alt="General" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="2149650" href="/Messages/2149650/Remove-Buttons-from-Standard-Menu-Bar.aspx">Remove Buttons from "Standard" Menu Bar</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=3069702">klarz</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">4:52 25 Jul '07 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F2149650_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:16px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="16px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">I am trying to figure out how to remove certain buttons from the "Standard" menu bar without removing the entire bar. Do you have any suggestions? <br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2149650" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/2149650/Remove-Buttons-from-Standard-Menu-Bar.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF2149650" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd HiVote HdUnSel " id="F2149832_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="34px" class="Frm_MsgIndent"><a name="xx2149832xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_answer.gif" alt="Answer" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="2149832" href="/Messages/2149832/Re-Remove-Buttons-from-Standard-Menu-Bar.aspx">Re: Remove Buttons from "Standard" Menu Bar</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=246471">sswater shi</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">6:02 25 Jul '07 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F2149832_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:34px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="34px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Look at demo vbs program in Office Help Document, if one certain button can be removed from Standard bar through VBScript, the vbscript can be translated into C++ line by line. <br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2149650" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/2149832/Re-Remove-Buttons-from-Standard-Menu-Bar.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF2149832" style="white-space:nowrap;">5.00/5 (1 vote) </span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="root msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd Rt HdUnSel " id="F1962340_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="16px" class="Frm_MsgIndent"><a name="xx1962340xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_general.gif" alt="General" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="1962340" href="/Messages/1962340/no-matching-symbolic-information-found.aspx">no matching symbolic information found?</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=3806556">Yakie</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">14:13 27 Mar '07 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F1962340_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:16px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="16px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Hi,<br />I try to run your source code and alter the path msword.olb according to my setting computer :<br />#import "C:\Program Files\Microsoft Office\Office11\MSWORD.OLB" rename_namespace("Word"), named_guids, rename("ExitWindows", "ExitWindowsEx")<br />using namespace Word;<br />But its result nothing to ms word and resulting these messages:<br /><br />Loaded 'C:\Program Files\Microsoft Office\OFFICE11\WINWORD.EXE', no matching symbolic information found.<br />Loaded 'ntdll.dll', no matching symbolic information found.<br />Loaded 'C:\WINDOWS\system32\kernel32.dll', no matching symbolic information found.<br />Loaded 'C:\WINDOWS\system32\advapi32.dll', no matching symbolic information found.<br />Loaded 'C:\WINDOWS\system32\rpcrt4.dll', no matching symbolic information found.<br />Loaded 'C:\WINDOWS\system32\gdi32.dll', no matching symbolic information found.<br />Loaded 'C:\WINDOWS\system32\user32.dll', no matching symbolic information found.<br />Loaded 'C:\WINDOWS\system32\ole32.dll', no matching symbolic information found.<br />Loaded 'C:\WINDOWS\system32\msvcrt.dll', no matching symbolic information found.<br />Loaded 'C:\WINDOWS\system32\shimeng.dll', no matching symbolic information found.<br />Loaded 'C:\Program Files\Common Files\Microsoft Shared\OFFICE11\MSO.DLL', no matching symbolic information found.<br />The thread 0xE14 has exited with code 0 (0x0).<br />The program 'C:\Program Files\Microsoft Office\OFFICE11\WINWORD.EXE' has exited with code 0 (0x0).<br /><br />then I install symbols from microsoft for the winxp sp2  but it still.<br /> what's wrong with setting my visual studio 6?<img src="/script/Forums/Images/smiley_confused.gif" align="top" alt="Confused" /> <br /><br /><img src="/script/Forums/Images/smiley_confused.gif" align="top" alt="Confused" />  <br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1962340" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/1962340/no-matching-symbolic-information-found.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF1962340" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd HdUnSel " id="F1962407_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="34px" class="Frm_MsgIndent"><a name="xx1962407xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_answer.gif" alt="Answer" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="1962407" href="/Messages/1962407/Re-no-matching-symbolic-information-found.aspx">Re: no matching symbolic information found?</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=246471">sswater shi</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">15:43 27 Mar '07 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F1962407_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:34px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="34px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">The type of this project is 'dll'. After you build this project, just launch 'winword.exe' dirrectly. The new toolbar will appear.<br /><br />If you want to trace into the source code,<br />project settings => Debug => Executable: 'c:\....\winword.exe'.<br /><br />If you fail again, you can download the setup file from its homepage:<br /><a href="http://www.regexlab.com/highlight/" target="_blank">http://www.regexlab.com/highlight/</a>
<a href="http://www.regexlab.com/download/?/highlight/demo_nt.msi" target="_blank">http://www.regexlab.com/download/?/highlight/demo_nt.msi</a> <br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1962340" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/1962407/Re-no-matching-symbolic-information-found.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF1962407" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd HdUnSel " id="F1978484_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="52px" class="Frm_MsgIndent"><a name="xx1978484xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_question.gif" alt="Question" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="1978484" href="/Messages/1978484/Re-no-matching-symbolic-information-found.aspx">Re: no matching symbolic information found?</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=3806556">Yakie</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">13:58 6 Apr '07 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F1978484_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:52px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="52px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">I still have problem with "no matching symbolic information found" for this project and other 'dll' projects. what OS & visual studio version that you use?<br />I am using OS windows XP SP2 & VS 6.0.<br />Thx <br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1962340" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/1978484/Re-no-matching-symbolic-information-found.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF1978484" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd HdUnSel " id="F1978538_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="70px" class="Frm_MsgIndent"><a name="xx1978538xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_answer.gif" alt="Answer" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="1978538" href="/Messages/1978538/Re-no-matching-symbolic-information-found.aspx">Re: no matching symbolic information found?</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=246471">sswater shi</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">16:23 6 Apr '07 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F1978538_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:70px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="70px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">But I think 'no matching symbolic information found' is not an error message.<br />Does the add-in work when 'no matching symbolic information found' appears ?<br /><br />Sswater Shi<br />Chongqing China<br /> <br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1962340" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/1978538/Re-no-matching-symbolic-information-found.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF1978538" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="root msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd Rt HdUnSel " id="F1522458_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="16px" class="Frm_MsgIndent"><a name="xx1522458xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_question.gif" alt="Question" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="1522458" href="/Messages/1522458/Chinese-Resources.aspx">Chinese Resources</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=90206">ianormy</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">2:05 8 Jun '06 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F1522458_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:16px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="16px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">I have written my toolbar to use English resources (the default). I also wish to use Chinese resources if it is running on a Chinese version of Win2K/XP. I notice that your toolbar has both resources defined (English and Chinese). How do you switch between the 2 versions of the resources? I cannot see anything obvious in the code.<br /><br />Thanks<br /><br />Ian Ormesher<br /> <br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1522458" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/1522458/Chinese-Resources.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF1522458" style="white-space:nowrap;">4.00/5 (1 vote) </span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd HdUnSel " id="F1522804_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="34px" class="Frm_MsgIndent"><a name="xx1522804xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_answer.gif" alt="Answer" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="1522804" href="/Messages/1522804/Re-Chinese-Resources.aspx">Re: Chinese Resources</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=246471">sswater shi</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">5:29 8 Jun '06 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F1522804_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:34px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="34px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">This is supported by System. We can simply use 'LoadString', 'FindResource' etc to load resource. These apis will return resource of the proper language.<br /><br />If you want to specify a language other than the current language, you can use 'FindResourceEx'.<br /><br />So, we need not to 'switch between the 2 versions of the resources'. <br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1522458" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/1522804/Re-Chinese-Resources.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF1522804" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="root msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd HiVote Rt HdUnSel " id="F1520844_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="16px" class="Frm_MsgIndent"><a name="xx1520844xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_question.gif" alt="Question" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="1520844" href="/Messages/1520844/How-did-you-automatically-install-the-toolbar.aspx">How did you automatically install the toolbar?</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=90206">ianormy</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">4:31 7 Jun '06 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F1520844_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:16px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="16px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">I also have created a COM addin and it works well. Following your recommendation I have made the toolbar permanent instead of temporary. However, when I install my toolbar it doesn't automatically appear in Word as your toolbar does the next time I start Word. My load behaviour is set exactly the same as yours. Do you do something special with your installer? The only way I can get my toolbar to appear is to use the tools->COM addins menu in Word and then add my toolbar dll manually. Obviously this is not very user friendly. Please can you give me some advice.<br /><br />Thanks<br /><br />Ian Ormesher<br /> <br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1520844" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/1520844/How-did-you-automatically-install-the-toolbar.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF1520844" style="white-space:nowrap;">5.00/5 (1 vote) </span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd HdUnSel " id="F1521721_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="34px" class="Frm_MsgIndent"><a name="xx1521721xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_answer.gif" alt="Answer" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="1521721" href="/Messages/1521721/Re-How-did-you-automatically-install-the-toolbar.aspx">Re: How did you automatically install the toolbar?</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=246471">sswater shi</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">16:01 7 Jun '06 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F1521721_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:34px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="34px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">There is nothing special in my install package, but the property 'Register' of the main dll file is 'COM Self Register'. Thus, 'DllRegisterServer' and 'DllUnregisterServer' will be invoked on installation and uninstallation respectively.<br /><br />There is one more point:<br /><br />If the 'msi' installer is launched as 'For All Users' (not 'For Me'), the registry infomatian of 'HKCU' (HKey Current User) will not be registered. So, in my source code, there are both 'HKCU' and 'HKLM' registry infomation.<br /><br />Good Luck!<br /> <br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1520844" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/1521721/Re-How-did-you-automatically-install-the-toolbar.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF1521721" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd HdUnSel " id="F1522186_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="52px" class="Frm_MsgIndent"><a name="xx1522186xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_general.gif" alt="General" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="1522186" href="/Messages/1522186/Re-How-did-you-automatically-install-the-toolbar.aspx">Re: How did you automatically install the toolbar?</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=90206">ianormy</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">22:55 7 Jun '06 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F1522186_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:52px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="52px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Thank you so much for your reply. I hadn't spotted the 2 registry items: HKCU and HKLM. I only had HKCU which would explain why an install 'For All Users' was not apparrently registering my toolbar.<br /><br />Ian<br /> <br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1520844" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/1522186/Re-How-did-you-automatically-install-the-toolbar.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF1522186" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr class="quick">
<td class="msg-divide"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="1px" alt="" /></td>
</tr>
<!-- Start Message head -->

<tr class="MsgHd HdUnSel " id="F1522225_h0">
<td width="100%"><table class="quickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr class="hover-row">
<td width="70px" class="Frm_MsgIndent"><a name="xx1522225xx"></a><img height="16px" width="16px" align="top" src="/script/Forums/Images/msg_general.gif" alt="General" /></td><td class="Frm_MsgSubject hover-container"><a id="DynMessLink" name="1522225" href="/Messages/1522225/Re-How-did-you-automatically-install-the-toolbar.aspx">Re: How did you automatically install the toolbar?</a> <a onclick="return Pin(this);" href="#" title="Click to pin message"><img src="http://s.codeproject.com/script/Forums/Images/pin.gif" border="0" align="top" alt="Pin" width="13px" height="12px" /></a></td><td style="width:20px;white-space:nowrap;"><img border="0" src="http://s.codeproject.com/script/Membership/Images/member_sm.gif" title="member" alt="member" height="16px" /></td><td class="Frm_MsgAuthor"><a href="/script/Membership/View.aspx?mid=246471">sswater shi</a></td><td class="Frm_MsgDate" style="vertical-align:top;white-space:nowrap;">23:18 7 Jun '06 &nbsp;</td>
</tr>
</table></td>
</tr><!-- End Message head -->

<tr id="F1522225_h1" style="display:none;">
<td width="100%"><table class="quickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="Frm_MsgIndent" style="width:70px;"><img src="http://s.codeproject.com/script/Forums/Images/t.gif" height="1px" width="70px" alt="" /></td><td class="MsgBd BdSel "><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">I do not know why the 'msiexec' does not process the 'HKCU' if you install it as 'For All User'. I have not made a deep research on 'msi' file.<br /><br />Anyhow, the reason of your problem is possibly that the registry item of 'HKCU' failed to be processed. <img src="/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile" />  <br /></td>
</tr><tr style="vertical-align:middle;">
<td class="msg-footer"><a class="toolbar" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fCOM%2fwordhighlight.aspx">Sign In</a>·<a class="toolbar" href="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1520844" title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" href="/Messages/1522225/Re-How-did-you-automatically-install-the-toolbar.aspx" title="Get permanent link">PermaLink</a></td><td class="msg-footer" style="text-align:right;"><span id="MVF1522225" style="white-space:nowrap;"></span></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr>
<td><img src="http://s.codeproject.com/script/Forums/Images/t.gif" border="0" width="1px" height="5px" alt="" /></td>
</tr>
</table></td>
</tr><tr>
<td><table width="100%" cellpadding="2px" cellspacing="0">
<tr class="forum-footer">
<td>Last Visit: 19:00 31 Dec '99  &nbsp; &nbsp; Last Update: 7:36 4 Jan '11 </td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/KB/COM/wordhighlight.aspx?fid=307468&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;fr=24" /><b>1</b></td>
</tr>
</table></td>
</tr>
</table>
</div><p class="small-text"><img align="top" src="/script/Forums/Images/msg_general.gif" width="16px" height="16px" alt="General" /> General &nbsp;&nbsp; <img align="top" src="/script/Forums/Images/msg_news.gif" width="16px" height="16px" alt="News" /> News &nbsp;&nbsp; <img align="top" src="/script/Forums/Images/msg_question.gif" width="16px" height="16px" alt="Question" /> Question &nbsp;&nbsp; <img align="top" src="/script/Forums/Images/msg_answer.gif" width="16px" height="16px" alt="Answer" /> Answer &nbsp;&nbsp; <img align="top" src="/script/Forums/Images/msg_joke.gif" width="16px" height="16px" alt="Joke" /> Joke &nbsp;&nbsp; <img align="top" src="/script/Forums/Images/msg_rant.gif" width="16px" height="16px" alt="Rant" /> Rant &nbsp;&nbsp; <img align="top" src="/script/Forums/Images/msg_admin.gif" width="16px" height="16px" alt="Admin" /> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+PgUp/PgDown to switch pages.</p>
<!-- Forum End -->




					
					<div class="theme1-background" style="height:2px"></div>

					<div class="extended tiny-text">
						<div class="row" style="margin:auto;">
							<div class="float-left">
								<a id="ctl00_PermaLink" href="/KB/COM/wordhighlight.aspx">PermaLink</a> | 
								<a id="ctl00_PrivacyLink" href="/info/privacy.aspx">Privacy</a> |
								<a id="ctl00_TermsOfUseLink" href="/info/TermsOfUse.aspx">Terms of Use</a>
								<br />Last Updated: 2 Feb 2007<br />
								<br />
							</div>
							<div class="float-right align-right">
								Copyright 2006 by sswater shi<br />Everything else
								Copyright &copy; <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2011 <br />
								Web19 |
								<a id="ctl00_AdvertiseLink" href="/info/MediaKit.aspx">Advertise on the Code Project </a>
							</div>
						</div>
					</div>
					

				
				</div>

				<div id="ctl00_ContentSide" class="text-sidebar">

					

					<script type="text/javascript">document.write(unescape('%0d%0a%3cdiv class%3d%22announce%22%3e%0d%0a%0d%0a%3cdiv class%3d%22announce-content%22%3e%09%0d%0a%0d%0a%0d%0a%3cdiv class%3d%22container-adwords%22%3e%0d%0a%09%3ca id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl00_Link%22 href%3d%22%2fscript%2fCatalog%2fRedir.aspx%3fctid%3d3265%26amp%3bcttype%3d2%22 target%3d%22_blank%22%3e%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl00_Title%22 class%3d%22title%22%3eBinaryVirtualizingWrapPanel .NET%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl00_Teaser%22 title%3d%22BinaryVirtualizingWrapPanel .NET is a UI Virtualization capable WrapPanel control for the Silverlight and WPF .NET applications.%22 class%3d%22desc%22%3eBinaryVirtualizingWrapPanel .NET is a UI...%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl00_Url%22 class%3d%22link%22%3ewww.binarymission.co.uk%3c%2fspan%3e%3c%2fa%3e%0d%0a%3c%2fdiv%3e%0d%0a%0d%0a%3cdiv class%3d%22container-adwords%22%3e%0d%0a%09%3ca id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl01_Link%22 href%3d%22%2fscript%2fCatalog%2fRedir.aspx%3fctid%3d3561%26amp%3bcttype%3d2%22 target%3d%22_blank%22%3e%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl01_Title%22 class%3d%22title%22%3eIntel%c2%ae Active Management Technology (Intel%c2%ae AMT) Software Development Kit (SDK)%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl01_Teaser%22 title%3d%22Make this new SDK version with corrections %26amp%3b improvements to redirection %26amp%3b KVM%2c MPS%2c timing issues and more%2c yours now! Enrich your app for Intel(r) AMT %26amp%3b be an IT Manager%26%2339%3bs %26%2339%3bgo to%26%2339%3b enterprise app!%22 class%3d%22desc%22%3eMake this new SDK version with corrections %26amp%3b...%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl01_Url%22 class%3d%22link%22%3esoftware.intel.com%3c%2fspan%3e%3c%2fa%3e%0d%0a%3c%2fdiv%3e%0d%0a%0d%0a%3cdiv class%3d%22container-adwords%22%3e%0d%0a%09%3ca id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl02_Link%22 href%3d%22%2fscript%2fCatalog%2fRedir.aspx%3fctid%3d3439%26amp%3bcttype%3d2%22 target%3d%22_blank%22%3e%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl02_Title%22 class%3d%22title%22%3eATI Stream SDK%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl02_Teaser%22 title%3d%22The ATI Stream Software Development Kit (SDK) is a complete development platform created by AMD to allow you to quickly and easily develop GPGPU applications accelerated by ATI Stream technology.%22 class%3d%22desc%22%3eThe ATI Stream Software Development Kit (SDK)...%3c%2fspan%3e%3cbr %2f%3e%0d%0a%09%09%3cspan id%3d%22ctl00_CatalogItems_FeatureItemRptr_ctl02_Url%22 class%3d%22link%22%3edeveloper.amd.com%3c%2fspan%3e%3c%2fa%3e%0d%0a%3c%2fdiv%3e%0d%0a%0d%0a%0d%0a%3c%2fdiv%3e%0d%0a%3c%2fdiv%3e%0d%0a%0d%0a%0d%0a'));</script>

					

					
<div class="announce">
<div class="announce-header">See Also...</div>
<div class="announce-content">	


<div class="container-related-item">
	<a id="ctl00_RelatedArticles_RelatedItemRptr_ctl00_TitleLink" class="title" href="/KB/aspnet/Creating_PDF_documents_in.aspx">Creating PDF Documents in ASP.NET</a><br />
	<span id="ctl00_RelatedArticles_RelatedItemRptr_ctl00_Teaser" class="desc">How to create PDF documents in ASP.NET.</span><br />
</div>

<div class="container-related-item">
	<a id="ctl00_RelatedArticles_RelatedItemRptr_ctl01_TitleLink" class="title" href="/KB/database/CsvReader.aspx">A Fast CSV Reader</a><br />
	<span id="ctl00_RelatedArticles_RelatedItemRptr_ctl01_Teaser" class="desc">A reader that provides fast, non-cached,...</span><br />
</div>

<div class="container-related-item">
	<a id="ctl00_RelatedArticles_RelatedItemRptr_ctl02_TitleLink" class="title" href="/KB/aspnet/ImportExportCSV.aspx">A Simplified SQL-CSV Import/Export Functionality</a><br />
	<span id="ctl00_RelatedArticles_RelatedItemRptr_ctl02_Teaser" class="desc">A simplified SQL-CSV import/export functionality.</span><br />
</div>

<div class="container-related-item">
	<a id="ctl00_RelatedArticles_RelatedItemRptr_ctl03_TitleLink" class="title" href="/KB/database/FinalCSVReader.aspx">Importing CSV Data and saving it in database</a><br />
	<span id="ctl00_RelatedArticles_RelatedItemRptr_ctl03_Teaser" class="desc">This article shows how to import CSV data and...</span><br />
</div>

<div class="container-related-item">
	<a id="ctl00_RelatedArticles_RelatedItemRptr_ctl04_TitleLink" class="title" href="/KB/database/TransferUsingSQLBulkCopy.aspx">Transferring Data Using SqlBulkCopy</a><br />
	<span id="ctl00_RelatedArticles_RelatedItemRptr_ctl04_Teaser" class="desc">An article on how to transfer data using...</span><br />
</div>

</div>
</div>




					

<div class="announce ">
<div class="announce-header">Announcements</div>
<div class="announce-content">
<table cellpadding="2">











<tr valign="middle"><td><img id="ctl00_Announcements_News_ctl00_Img" src="/script/News/NewsImages/13270.png" alt="News" align="middle" style="height:24px;width:24px;border-width:0px;" /></td>
<td><a id="ctl00_Announcements_News_ctl00_Link" href="http://www.codeproject.com/Competitions/440/Windows-Azure-App-Competition.aspx">Got an Azure app? Win an Xbox & Kinect</a></td></tr>




</table>
</div>
</div>

					
<div class="announce">
<div class="announce-header">The Daily Insider</div>
<div class="announce-content">

<div><a id="ctl00_News_News_ctl01_Link" href="http://citizen428.net/archives/434">30 free programming books</a></div>

Daily News: <a id="ctl00_News_News_ctl02_Subscribe" href="/Feature/Insider/">Signup now</a>.
</div>
</div>
		

					<div style="margin:auto;width:150px"><div class="lqm_ad" width="150px" height="80px" lqm_channel="1" lqm_publisher="495" lqm_zone="77" lqm_format="21" lqm_country='IR' lqm_tags='VC6,Win2K,WinXP,Win2003,Dev,COM,Intermediate'></div>
					</div>
	
					<div style="margin:auto;width:160px;margin-top:10px"><div class="lqm_ad" width="160px" height="600px" lqm_channel="1" lqm_publisher="495" lqm_zone="77" lqm_format="18" lqm_country='IR' lqm_tags='VC6,Win2K,WinXP,Win2003,Dev,COM,Intermediate'></div>
					</div>
				</div>

			</div>
			

		</div>
		

	</div>
</div>


<script type="text/javascript" language="Javascript" src="http://ajax.microsoft.com/ajax/jQuery/jquery-1.4.2.min.js"></script><script type='text/javascript'>//<![CDATA[
if (typeof jQuery == 'undefined') {
    document.write(unescape("%3Cscript src='/script/JS/jquery-1.4.2.min.js' type='text/javascript' %3E%3C/script%3E"));
}//]]></script>
<script type="text/javascript" language="Javascript" src="http://s.codeproject.com/script/Articles/JS/article.min.js?dt=2.3.110104.1"></script>
<script type="text/javascript" language="Javascript" src="http://cdn1.lakequincy.com/m.min.js?dt=2.3.110104.1"></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
var socialLinks = new social();
socialLinks.PlaceholderId="ATD";socialLinks.ObjectId=14160;
socialLinks.ObjectTypeId=2;
socialLinks.addtoMethod=1;
socialLinks.Horizontal=false;
socialLinks.Showname=true;
socialLinks.setupLinks("socialLinks", escape(document.location.href),escape(document.title), 100, 0, "small-text Bold", "AddTo");
socialLinks.setupMenu();
if($.LqmAds)$.LqmAds();
var oSrchFlt = false, oSrchBox=false,srchBoxFoc=false;
$(document).ready(function() {
 InitWatermark('sb_tb', 'Search');
 var sbar = $('#sb_tb'); 
 var sfilter = $('#SearchFilter');
 if (sbar && sfilter) {
  sfilter.removeClass('popup'); sfilter.hide();
  sbar.blur(function() { if (!oSrchFlt)sfilter.hide();srchBoxFoc=false; });
  sbar.focus(function() { oSrchFlt=false;srchBoxFoc=true;sfilter.show(); });
  sbar.mouseleave(function() { oSrchBox=false; });
  sbar.mouseover(function() { oSrchBox=true; });
  sfilter.mouseleave(function() { oSrchFlt=false; if (!srchBoxFoc&&!oSrchBox)sfilter.hide();});
  sfilter.mouseover(function() { oSrchFlt=true; });
 }
});
$("#ctl00_RateArticle_RateItemWrapper").removeClass("container-rating");$('#clear-rate_ctl00_RateArticle_RCD').click(function () { $('#ctl00_RateArticle_RCD').hide(); return false;});
function ChkRtctl00_RateArticle(val, objId) {if (val<=3||true) {
$('div[name=RateItem_' + objId + '] .rating-comment').css("display","");}
else $('div[name=RateItem_' + objId + '] .rating-comment').css("display","none");}


//]]>
</script>



<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-1735123-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_setDomainName', 'www.codeproject.com']);
	_gaq.push(['_setSessionTimeout', '1200']); 

	(function () {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})(); 
</script>

</body>
</html>
